org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.assessmentbrowser-1.1/editor/assessmentbrowser_util.js', 'js')
org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.assessmentbrowser-1.1/editor/libs/xml2json.js', 'js')
org.ekstep.pluginframework.pluginManager.registerPlugin({"id":"org.ekstep.assessmentbrowser","ver":"1.1","shortId":"assessmentbrowser","author":"Santhosh Vasabhaktula","title":"AssessmentBrowser Plugin","description":"","publishedDate":"","editor":{"main":"editor/plugin.js","dependencies":[{"type":"plugin","plugin":"org.ekstep.conceptselector","ver":"1.1"},{"type":"js","src":"editor/assessmentbrowser_util.js"},{"type":"js","src":"editor/libs/xml2json.js"}]}},eval('org.ekstep.contenteditor.basePlugin.extend({type:"assessmentbrowser",previewURL:(ecEditor.getConfig("previewURL")||"/content/preview/preview.html")+"?webview=true",callback:function(){},initialize:function(){var e=this;ecEditor.addEventListener(this.manifest.id+":show",this.showAssessmentBrowser,this),setTimeout(function(){var s=ecEditor.resolvePluginResource(e.manifest.id,e.manifest.ver,"editor/assessmentbrowser.html"),t=ecEditor.resolvePluginResource(e.manifest.id,e.manifest.ver,"editor/assessmentbrowserapp.js");ecEditor.getService("popup").loadNgModules(s,t)},1e3)},showAssessmentBrowser:function(e,s){var t=this;this.callback=s.callback,this.data=ecEditor._.isUndefined(s.data)?"":s.data,ecEditor.getService("popup").open({template:"assessmentbrowser",controller:"assessmentbrowsercontroller",controllerAs:"$ctrl",resolve:{instance:function(){return t}},width:900,showClose:!1,className:"ngdialog-theme-plain"})}});'))
org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.assetbrowser-1.2/editor/recorder/wave/wavesurfer.min.js', 'js')
org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.assetbrowser-1.2/editor/recorder/angular-audio-recorder.js', 'js')
org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.assetbrowser-1.2/editor/libs/angular-inview.js', 'js')
org.ekstep.pluginframework.pluginManager.registerPlugin({"id":"org.ekstep.assetbrowser","ver":"1.2","shortId":"assetbrowser","author":"Sunil A S","title":"Asset Browser","description":"","publishedDate":"","editor":{"main":"editor/plugin.js","dependencies":[{"type":"js","src":"editor/recorder/wave/wavesurfer.min.js"},{"type":"js","src":"editor/recorder/angular-audio-recorder.js"},{"type":"js","src":"editor/libs/angular-inview.js"}],"views":[{"template":"./assetBrowser.html","controller":"./assetbrowserapp.js"}]}},eval('org.ekstep.contenteditor.basePlugin.extend({type:"assetbrowser",initData:void 0,cb:void 0,initialize:function(){var e=this;org.ekstep.contenteditor.api.addEventListener(this.manifest.id+":show",this.initPreview,this);var t=org.ekstep.contenteditor.api.resolvePluginResource(e.manifest.id,e.manifest.ver,"editor/assetBrowser.html"),i=org.ekstep.contenteditor.api.resolvePluginResource(e.manifest.id,e.manifest.ver,"editor/assetbrowserapp.js");org.ekstep.contenteditor.api.getService("popup").loadNgModules(t,i)},initPreview:function(e,t){var i=this;this.cb=t.callback,this.mediaType=t.type,this.search_filter=t.search_filter,org.ekstep.contenteditor.api.getService("popup").open({template:"partials/assetbrowser.html",controller:"browsercontroller",controllerAs:"$ctrl",resolve:{instance:function(){return i}},showClose:!1,className:"ngdialog-theme-plain"})},getAsset:function(e,t,i,r,o){var s,n;s={request:{filters:{mediaType:t,contentType:"Asset",compatibilityLevel:{min:1,max:2},status:new Array("Live","Review","Draft")},limit:50,offset:r}},org.ekstep.contenteditor.api._.isUndefined(e)||(s.request.query=e),org.ekstep.contenteditor.api._.isUndefined(i)?(s.request.filters.license="Creative Commons Attribution (CC BY)",n=org.ekstep.contenteditor.api._.omit(this.search_filter,["mediaType","license","limit"])):(s.request.filters.createdBy=i,n=org.ekstep.contenteditor.api._.omit(this.search_filter,["mediaType","limit","createdBy"])),org.ekstep.contenteditor.api._.merge(s.request.filters,n);org.ekstep.contenteditor.api.getService(ServiceConstants.SEARCH_SERVICE);ecEditor.getService("search").search(s,function(e,t){e||"OK"!=t.data.responseCode?o(e,null):o(null,t)})},showAssetBrowser:function(e,t){},fileValidation:function(e,t,i){if(window.File&&window.FileList&&window.Blob){var r=org.ekstep.contenteditor.api.jQuery("#"+e)[0].files[0].size,o=org.ekstep.contenteditor.api.jQuery("#"+e)[0].files[0].type;return r>t?(alert("File size is higher than the allowed size!"),!1):!o||(-1!=org.ekstep.contenteditor.api.jQuery.inArray(o,i)||(alert("File type is not allowed!"),!1))}return!0}});'))
org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.colorpicker-1.0/editor/libs/spectrum.js', 'js')
org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.colorpicker-1.0/editor/libs/spectrum.css', 'css')
org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.colorpicker-1.0/editor/colorpickerplugin.css', 'css')
org.ekstep.pluginframework.pluginManager.registerPlugin({"id":"org.ekstep.colorpicker","ver":"1.0","author":"Chetan Sachdev","title":"Colorpicker Plugin","description":"","publishedDate":"","editor":{"main":"editor/plugin.js","dependencies":[{"type":"js","src":"editor/libs/spectrum.js"},{"type":"css","src":"editor/libs/spectrum.css"},{"type":"css","src":"editor/colorpickerplugin.css"}],"menu":[]},"renderer":{}},eval('org.ekstep.contenteditor.basePlugin.extend({type:"colorpicker",picker:[],initialize:function(){ecEditor.addEventListener("colorpicker:state",this.invoke,this)},invoke:function(e,t){var c=this;"added"!=ecEditor.jQuery("#"+t.id+" input").attr("colorpicker")&&(this.picker[t.id]=ecEditor.jQuery("#"+t.id+" input").spectrum({color:"#FF0000",showInput:!0,showAlpha:!1,preferredFormat:"hex",showButtons:!1,containerClassName:"awesome",clickoutFiresChange:!1,showButtons:!0,change:function(e){t.callback(t.id,e.toHexString()),ecEditor.getService(ServiceConstants.TELEMETRY_SERVICE).interact({type:"click",subtype:"change",target:"colorpicker",pluginid:c.manifest.id,pluginver:c.manifest.ver,objectid:t.id,stage:ecEditor.getCurrentStage().id})},showPaletteOnly:!0,togglePaletteOnly:!0,togglePaletteMoreText:"more",togglePaletteLessText:"less",color:"blanchedalmond",palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]],maxSelectionSize:10,hideAfterPaletteSelect:!0,move:function(e){t.callback(t.id,e.toHexString()),ecEditor.getService(ServiceConstants.TELEMETRY_SERVICE).interact({type:"click",subtype:"move",target:"colorpicker",pluginid:c.manifest.id,pluginver:c.manifest.ver,objectid:t.id,stage:ecEditor.getCurrentStage().id})}}),ecEditor.jQuery("#"+t.id+" input").attr("colorpicker","added")),t&&t.color?ecEditor.jQuery("#"+t.id+" input").spectrum("set",t.color):ecEditor.jQuery("#"+t.id+" input").spectrum("set","#000000")}});'))
org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.conceptselector-1.1/editor/semantic-ui-tree-picker.js', 'js')
org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.conceptselector-1.1/editor/semantic-ui-tree-picker.css', 'css')
org.ekstep.pluginframework.pluginManager.registerPlugin({"id":"org.ekstep.conceptselector","ver":"1.1","author":"Santhosh Vasabhaktula","title":"Concept Selector Plugin","description":"","publishedDate":"","editor":{"main":"editor/plugin.js","dependencies":[{"type":"js","src":"editor/semantic-ui-tree-picker.js"},{"type":"css","src":"editor/semantic-ui-tree-picker.css"}]}},eval('org.ekstep.contenteditor.basePlugin.extend({conceptData:void 0,callback:void 0,limit:500,selectors:[],concepts:[],initialize:function(){var e=this;ecEditor.addEventListener(e.manifest.id+":init",this.initConceptBrowser,this)},initData:function(e,t){function n(e,t){var i=[];return ecEditor._.forEach(t,function(c){if(void 0!=c.parent&&c.parent[0]==e){var r={};r.id=c.identifier,r.name=c.name,r.selectable="selectable",r.nodes=n(c.identifier,t),i.push(r)}}),ecEditor._.uniqBy(i,"id")}var e=e||this,i=[],c={request:{filters:{objectType:["Dimension","Domain"]}}};ecEditor.getService("search").search(c,function(c,r){!c&&r.data&&r.data.result&&ecEditor._.isArray(r.data.result.domains)?(ecEditor._.forEach(r.data.result.domains,function(t){var c={};c.id=t.identifier,c.name=t.name;var a=[];ecEditor._.forEach(n(t.identifier,r.data.result.dimensions),function(t){var i={};i.id=t.id,i.name=t.name,i.nodes=n(t.id,e.concepts),a.push(i)}),c.nodes=a,i.push(c)}),t&&t()):t&&t()}),this.conceptData=i},getConcept:function(e,t,n,i){var n=n||this;e=e||0;var c={request:{filters:{objectType:["Concept"]},offset:e,limit:t}};ecEditor.getService("search").search(c,function(c,r){!c&&r.data&&r.data.result&&ecEditor._.isArray(r.data.result.concepts)&&(ecEditor._.forEach(r.data.result.concepts,function(e){n.concepts.push(e)}),r.data.result.count>r.data.result.concepts.length+e?(e+=r.data.result.concepts.length,e!==r.data.result.count?n.getConcept(e,t,n,i):i(n)):i(n))})},initConceptBrowser:function(e,t){var n=this;n.concepts.length?-1==n.selectors.indexOf(t.element)&&setTimeout(function(){ecEditor.jQuery("#"+t.element).treePicker({data:n.conceptData,name:"Concepts",picked:t.selectedConcepts,onSubmit:function(e){t.callback(e),t.selectedConcepts=_.map(e,"id"),n.generateTelemetry({type:"click",subtype:"submit",target:"ConceptSelectorSubmit"})},onCancel:function(){n.initConceptBrowser(e,t)},nodeName:"conceptSelector_"+t.element,minSearchQueryLength:1})},1e3):n.getConcept(0,n.limit,n,function(){n.initData(n,function(){-1==n.selectors.indexOf(t.element)&&setTimeout(function(){ecEditor.jQuery("#"+t.element).treePicker({data:n.conceptData,name:"Concepts",picked:t.selectedConcepts,onSubmit:function(e){t.callback(e),t.selectedConcepts=_.map(e,"id"),n.generateTelemetry({type:"click",subtype:"submit",target:"ConceptSelectorSubmit"})},onCancel:function(){n.initConceptBrowser(e,t)},nodeName:"conceptSelector_"+t.element,minSearchQueryLength:1})},1e3)})})},generateTelemetry:function(e){var t=this;e&&ecEditor.getService("telemetry").interact({type:e.type,subtype:e.subtype,id:e.target,pageid:org.ekstep.contenteditor.api.getCurrentStage().id||"",target:{id:e.targetid||"",type:"plugin",ver:""},plugin:{id:t.manifest.id,ver:t.manifest.ver,category:"core"},ver:"3.0"})}});'))
org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.stage-1.0/editor/libs/html2canvas.js', 'js')
org.ekstep.pluginframework.pluginManager.registerPlugin({"id":"org.ekstep.stage","ver":"1.0","author":"Santhosh Vasabhaktula","title":"Stage Plugin","description":"","publishedDate":"","editor":{"main":"editor/plugin.js","dependencies":[{"type":"js","src":"editor/libs/html2canvas.js"}],"help":{"src":"editor/help.md","dataType":"text"},"menu":[{"id":"stage","category":"main","type":"icon","toolTip":"Add Slide","title":"Stage","iconClass":"icon-newstage icon","onclick":{"id":"stage:create","data":{"position":"afterCurrent"}},"submenu":[{"id":"beginning","type":"icon","title":"Beginning","iconClass":"fast backward icon","onclick":{"id":"stage:create","data":{"position":"beginning"}}},{"id":"end","type":"icon","title":"End","iconClass":"fast forward icon","onclick":{"id":"stage:create","data":{"position":"end"}}},{"id":"front","type":"icon","title":"After current","iconClass":"forward icon","onclick":{"id":"stage:create","data":{"position":"afterCurrent"}}},{"id":"back","type":"icon","title":"Before current","iconClass":"backward icon","onclick":{"id":"stage:create","data":{"position":"beforeCurrent"}}}]}],"configManifest":[{"propertyName":"genieControls","title":"Show Player Control","description":"Toggle genie controls","dataType":"boolean","required":true,"defaultValue":true},{"propertyName":"instructions","title":"Teacher Instructions","description":"Teacher Instructions","dataType":"textarea","required":true,"defaultValue":""},{"propertyName":"color","title":"Background color","description":"Slide Background color","dataType":"colorpicker","required":true,"defaultValue":"#FFFFFF"}]},"dependencies":[{"type":"plugin","plugin":"org.ekstep.navigation","ver":"1.0","scope":"renderer"}]},eval('org.ekstep.contenteditor.basePlugin.extend({type:"stage",thumbnail:void 0,onclick:void 0,currentObject:void 0,canvas:void 0,initialize:function(){ecEditor.addEventListener("stage:create",this.createStage,this),ecEditor.addEventListener("object:modified",this.modified,this),ecEditor.addEventListener("stage:modified",this.modified,this),ecEditor.addEventListener("object:selected",this.objectSelected,this),ecEditor.addEventListener("object:removed",this.objectRemoved,this)},createStage:function(t,e){ecEditor.instantiatePlugin(this.manifest.id,e)},newInstance:function(){if(this.onclick={id:"stage:select",data:{stageId:this.id}},this.ondelete={id:"stage:delete",data:{stageId:this.id}},this.duplicate={id:"stage:duplicate",data:{stageId:this.id}},this.editorData.stageECML){var t=JSON.parse(this.editorData.stageECML.config.__cdata);this.addConfig("color",t.color||"#FFFFFF"),this.setSlideBackground(t.color||"#FFFFFF")}else this.addConfig("color",this.config.color||"#FFFFFF");ecEditor.addStage(this),this.attributes={x:0,y:0,w:720,h:405,id:this.id},this.addConfig("instructions",this.getParam("instructions")||"")},getOnClick:function(){return{id:"stage:select",data:{stageId:this.id,prevStageId:ecEditor.getCurrentStage().id}}},setCanvas:function(t){this.canvas=t},addChild:function(t){this.children.push(t),t.editorObj&&(this.canvas.add(t.editorObj),t.editorObj.selectable&&this.canvas.setActiveObject(t.editorObj),this.setThumbnail(),ecEditor.dispatchEvent("stage:modified",{id:t.id}))},setThumbnail:function(){if(org.ekstep.contenteditor.stageManager.contentLoading)this.thumbnail=this.canvas.toDataURL({format:"jpeg",quality:.1});else{var t=ecEditor.getCurrentStage();t.canvas;html2canvas($("#canvas-wrapper"),{onrendered:function(e){t.thumbnail=e.toDataURL({format:"jpeg",quality:.1}),org.ekstep.contenteditor.stageManager.thumbnails[t.id]=t.thumbnail;var i=ecEditor.getAngularScope();ecEditor.ngSafeApply(i)}})}},updateZIndex:function(){var t=this;ecEditor._.forEach(this.children,function(e){e.editorObj?e.attributes["z-index"]=t.canvas.getObjects().indexOf(e.editorObj):e.attributes["z-index"]=_.isUndefined(e.attributes["z-index"])?t.canvas.getObjects().length:e.attributes["z-index"]})},render:function(t){var e=this;if(org.ekstep.contenteditor.stageManager.clearCanvas(t),this.children=ecEditor._.sortBy(this.children,[function(t){return t.getAttribute("z-index")}]),ecEditor._.forEach(this.children,function(e){e.render(t)}),this.config.color&&t.setBackgroundColor(this.config.color,t.renderAll.bind(t)),t.renderAll(),ecEditor.dispatchEvent("stage:render:complete",{stageId:this.id}),org.ekstep.contenteditor.stageManager.contentLoading)this.thumbnail=t.toDataURL({format:"jpeg",quality:.1});else{var e=this;html2canvas($("#canvas-wrapper"),{onrendered:function(t){e.thumbnail=t.toDataURL({format:"jpeg",quality:.1});var i=ecEditor.getAngularScope();ecEditor.ngSafeApply(i)},timeout:0})}ecEditor.refreshStages(),ecEditor.dispatchEvent("stage:render:complete",{stageId:this.id})},modified:function(t,e){ecEditor.getCurrentStage().updateZIndex(),ecEditor.getCurrentStage().setThumbnail(),ecEditor.refreshStages()},objectSelected:function(t,e){if(!ecEditor._.isUndefined(this.currentObject)&&this.currentObject!==e.id){var i=ecEditor.getPluginInstance(this.currentObject);ecEditor.getCanvas().trigger("selection:cleared",{target:i.editorObj})}this.currentObject=e.id},objectRemoved:function(t,e){this.currentObject=void 0},destroyOnLoad:function(t,e,i){var n=this;t==n.children.length?(e.clear(),n.render(e),$("#"+n.id).remove(),i()):setTimeout(function(){n.destroyOnLoad(t,e,i)},1e3)},getConfigManifest:function(){return this.manifest.editor.configManifest},getConfig:function(){var t=this._super();return t.genieControls=ecEditor.getAngularScope().showGenieControls,t},onConfigChange:function(t,e){switch(t){case"instructions":this.addParam("instructions",e);break;case"genieControls":if(e!==ecEditor.getAngularScope().showGenieControls){var i=ecEditor.getAngularScope();ecEditor.ngSafeApply(i,function(){i.toggleGenieControl()})}break;case"color":this.setSlideBackground(e),ecEditor.dispatchEvent("stage:modified"),ecEditor.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})}},setSlideBackground:function(t){var e;ecEditor._.forEach(ecEditor.getCurrentStage().children,function(t){"slidebackground"==t.attributes.subtype&&(e=t)}),e?e.attributes.fill=t:"#FFFFFF"!==t&&ecEditor.instantiatePlugin("org.ekstep.shape",{type:"rect",subtype:"slidebackground",x:0,y:0,fill:t,w:100,h:100,stroke:"rgba(255, 255, 255, 0)",strokeWidth:1,opacity:1,"z-index":-999},ecEditor.getCurrentStage()),ecEditor.getCurrentStage().canvas.backgroundColor=t,this.config.color=t},updateThumbnail:function(){$("<canvas>").attr({id:this.id}).css({width:"720px",height:"405px"}).appendTo("#thumbnailCanvasContainer"),canvas=new fabric.Canvas(this.id,{backgroundColor:"#FFFFFF",preserveObjectStacking:!0,width:720,height:405}),this.render(canvas),ecEditor.jQuery("#"+this.id).remove()}});'))
org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.text-1.2/editor/texteditor.js', 'js')
org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.text-1.2/editor/multilineTransliterator.js', 'js')
org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.text-1.2/editor/textWYSIWYG.js', 'js')
org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.text-1.2/editor/style/plugin.css', 'css')
org.ekstep.pluginframework.pluginManager.registerPlugin({"id":"org.ekstep.text","ver":"1.2","shortId":"org.ekstep.text","displayName":"Text","author":"Santhosh Vasabhaktula","title":"Text Plugin","description":"","publishedDate":"","editor":{"main":"editor/plugin.js","dependencies":[{"type":"js","src":"editor/texteditor.js"},{"type":"js","src":"editor/multilineTransliterator.js"},{"type":"js","src":"editor/textWYSIWYG.js"},{"type":"css","src":"editor/style/plugin.css"}],"views":[{"template":"./delete_confirmation_dialog.html","controller":""},{"template":"./transliterationconfig.html","controller":"./transliterationapp.js"}],"menu":[{"id":"org.ekstep.text","category":"main","type":"icon","toolTip":"Add Text","title":"Text","iconClass":"fa fa-font","onclick":{"id":"org.ekstep.text:create","data":{"__text":"","x":10,"y":20,"fontFamily":"NotoSans","fontSize":18,"minWidth":20,"w":35,"maxWidth":500,"fill":"#000000","fontStyle":"normal","fontWeight":"normal","stroke":"rgba(255, 255, 255, 0)","strokeWidth":1,"opacity":1,"editable":false,"lineHeight":1,"version":"V2","offsetY":0.2}},"submenu":[{"id":"beginning","type":"icon","title":"Add Richtext","iconClass":"","onclick":{"id":"org.ekstep.richtext:showpopup"}}]}],"behaviour":{"rotatable":true},"configManifest":[{"type":"custom_template","controllerURL":"editor/config-controller.js","templateURL":"editor/configTemplate.html"}],"help":{"src":"editor/help.md","dataType":"text"},"init-data":{"__text":"","x":10,"y":20,"fontFamily":"NotoSans","fontSize":18,"minWidth":20,"w":35,"maxWidth":500,"fill":"#000000","fontStyle":"normal","fontWeight":"normal"}},"renderer":{"main":"renderer/supertextplugin.js"}},eval('org.ekstep.contenteditor.basePlugin.extend({type:"org.ekstep.text",magicNumber:1920,editorWidth:720,supportedFonts:["NotoSans","NotoSansBengali","NotoSansDevanagari","NotoSansGujarati","NotoSansGurmukhi","NotoSansKannada","NotoSansMalayalam","NotoSansOriya","NotoSansTamil","NotoSansTelugu","NotoNastaliqUrdu"],constants:{v2supportedText:"text",createJsLineHeight:1.3},initialize:function(){var t=this;ecEditor.addEventListener(this.type+":showpopup",this.loadHtml,this),ecEditor.addEventListener("object:unselected",this.objectUnselected,this),ecEditor.addEventListener("stage:unselect",this.stageUnselect,this),ecEditor.addEventListener(this.type+":readalong:show",this.showReadalong,this),ecEditor.addEventListener(this.type+":wordinfo:show",this.showWordInfo,this),ecEditor.addEventListener(this.type+":delete:enhancement",this.deleteEnhancement,this),ecEditor.addEventListener(this.type+":modified",this.modifyText,this);var e=ecEditor.resolvePluginResource(t.manifest.id,t.manifest.ver,"editor/delete_confirmation_dialog.html");ecEditor.getService("popup").loadNgModules(e);var i=ecEditor.resolvePluginResource(t.manifest.id,t.manifest.ver,"editor/transliterationconfig.html"),o=ecEditor.resolvePluginResource(t.manifest.id,t.manifest.ver,"editor/transliterationapp.js");org.ekstep.contenteditor.api.getService(ServiceConstants.POPUP_SERVICE).loadNgModules(i,o)},modifyText:function(t){this.checkMigrate(),this.dblClickHandler(t)},checkMigrate:function(){this.isV2Plugin(ecEditor.getCurrentObject())||ecEditor.dispatchEvent(this.type+":migrate",ecEditor.getCurrentObject())},loadHtml:function(){var t=this;org.ekstep.contenteditor.api.getService(ServiceConstants.POPUP_SERVICE).open({template:"transliteration",controller:"transliterationController",controllerAs:"$ctrl",resolve:{instance:function(){return t}},width:900,showClose:!1})},createTransliteratedText:function(t){var e=org.ekstep.contenteditor.api.getCurrentObject(),i={__text:t,x:30,y:30,w:300,h:500,fontFamily:"NotoSans",fontSize:18,minWidth:20,maxWidth:500,fill:"#000"};e&&(i.x=e.attributes.x,i.y=e.attributes.y,i.w=e.attributes.w,i.h=e.attributes.h,i.fontFamily=e.attributes.fontFamily,i.fontSize=e.attributes.fontSize,i.minWidth=e.attributes.minWidth,i.maxWidth=e.attributes.maxWidth,i.color=e.attributes.color,this.pixelToPercent(i),i=this.getOffsetPosition(i)),org.ekstep.contenteditor.api.instantiatePlugin(e.type,i,org.ekstep.contenteditor.api.getCurrentStage())},getOffsetPosition:function(t){return t.x+t.w<50?t.x=50:t.x>=50?t.x=12:t.y+t.h<50?t.y=50:t.y>=50?t.y=12:(t.x+=20,t.y+=20),t},newInstance:function(){var t=this.convertToFabric(this.attributes);if(delete t.__text,ecEditor._.isUndefined(this.config.text)&&(this.config.text=ecEditor._.isUndefined(this.attributes.__text)?"":this.attributes.__text),ecEditor._.isUndefined(this.attributes.__text)||delete this.attributes.__text,t.editable=!1,this.editorObj=new fabric.ITextbox(this.config.text,t),""==this.config.text&&textEditor.showEditor(this.id),ecEditor._.isUndefined(this.attributes.timings)&&"readalong"!==this.attributes.textType)if(ecEditor._.isUndefined(this.attributes.words)&&"wordinfo"!==this.attributes.textType)this.attributes.textType="text";else{var e=this;this.addMedia({id:"org.ekstep.text.popuptint",src:ecEditor.resolvePluginResource(e.manifest.id,e.manifest.ver,"assets/popuptint.png"),type:"image",assetId:"org.ekstep.text.popuptint"}),this.addWordinfoconfigManifest(this)}else{if(ecEditor._.isUndefined(this.attributes.textType)){this.attributes.textType="readalong",this.config.audio=this.attributes.audio,this.config.timings=this.attributes.timings,this.config.highlight=this.attributes.highlight,this.config.autoplay=this.attributes.autoplay;var i=ecEditor.getMedia(this.attributes.audio);i.src=org.ekstep.contenteditor.mediaManager.getMediaOriginURL(i.src),ecEditor._.isUndefined(i.preload)&&(i.preload=!0),this.config.audioObj=i}this.addMedia(this.config.audioObj),this.addReadalongconfigManifest(this)}this.isV2Plugin()&&TextWYSIWYG.setInstance(this)},selected:function(t){fabric.util.addListener(fabric.document,"dblclick",this.dblClickHandler)},deselected:function(t,e,i){fabric.util.removeListener(fabric.document,"dblclick",this.dblClickHandler)},objectUnselected:function(t,e){fabric.util.removeListener(fabric.document,"dblclick",this.dblClickHandler)},dblClickHandler:function(t){var e=ecEditor.getCurrentObject().editorObj.getBoundingRect(),i=ecEditor.jQuery("#canvas").offset().left+ecEditor.getCurrentObject().editorObj.left,o=i+ecEditor.getCurrentObject().editorObj.width,r=ecEditor.jQuery("#canvas").offset().top+ecEditor.getCurrentObject().editorObj.top,n=r+ecEditor.getCurrentObject().editorObj.height;_.isObject(e)&&(i=ecEditor.jQuery("#canvas").offset().left+e.left,eftEnd=i+e.width,r=ecEditor.jQuery("#canvas").offset().top+e.top,n=r+e.height),t.clientX>i&&t.clientX<o&&t.clientY>r&&t.clientY<n&&textEditor.showEditor(ecEditor.getEditorObject().id),textEditor.generateTelemetry({type:"click",subtype:"doubleClick",target:"textEditor"})},stageUnselect:function(t){textEditor.hide()},getAttributes:function(){var t=ecEditor._.omit(ecEditor._.clone(this.attributes),["top","left","width","height","fontFamily","fontfamily","fontSize","fontstyle","fontweight","scaleX","scaleY"]);t.font=this.editorObj.get("fontFamily"),t.fontsize=this.updateFontSize(this.editorObj.get("fontSize"),!1);var e=ecEditor._.isUndefined(this.editorObj.get("fontWeight"))?"":"bold"===this.editorObj.get("fontWeight")?"bold":"",i=ecEditor._.isUndefined(this.editorObj.get("fontStyle"))?"":"italic"===this.editorObj.get("fontStyle")?"italic":"";return t.weight=(e+" "+i).trim(),t},onConfigChange:function(t,e){switch(t){case"fontweight":this.editorObj.setFontWeight(e?"bold":"normal"),this.attributes.fontweight=e;break;case"fontstyle":this.editorObj.setFontStyle(e?"italic":"normal"),this.attributes.fontstyle=e;break;case"fontfamily":this.editorObj.setFontFamily(e),this.attributes.fontFamily=e,this.attributes.fontfamily=e;break;case"fontsize":this.editorObj.setFontSize(e),this.attributes.fontSize=e;break;case"textcolor":this.editorObj.setFill(e),this.attributes.color=e;break;case"align":this.editorObj.setTextAlign(e),this.attributes.align=e;break;case"highlightcolorpicker":this.config.highlight=e;break;case"autoplay":this.config.autoplay=e;break;case"wordfontcolorpicker":this.config.wordfontcolor=e;break;case"wordhighlightcolorpicker":this.config.wordhighlightcolor=e;break;case"wordunderlinecolorpicker":this.config.wordunderlinecolor=e}this.isV2Plugin()&&TextWYSIWYG.setInstance(this),ecEditor.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})},getConfig:function(){var t=this._super();return t.color=this.attributes.color||this.attributes.fill,t.fontfamily=this.attributes.fontFamily,t.fontsize=this.attributes.fontSize,t.fontweight=this.attributes.fontweight||!1,t.fontstyle=this.attributes.fontstyle||!1,t.align=this.attributes.align||"left",t},getProperties:function(){var t=ecEditor._.omitBy(ecEditor._.clone(this.attributes),ecEditor._.isObject);return t=ecEditor._.omitBy(t,ecEditor._.isNaN),delete t.__text,t.text=this.editorObj.text,this.pixelToPercent(t),t},updateFontSize:function(t,e){var i=void 0;if(e){var o=this.attributes.w*(this.magicNumber/100),r=this.editorWidth*this.attributes.w/100;i=parseInt(Math.round(t*(r/o)).toString())}else{var o=this.editorObj.width/this.magicNumber*100,r=this.editorObj.width/this.editorWidth*100,n=t*(this.editorObj.scaleX||1);i=parseFloat((n*(r/o)).toFixed(2))}return i},convertToFabric:function(t){var e=ecEditor._.clone(t);if(t.x&&(e.left=t.x),t.y&&(e.top=t.y),t.w&&(e.width=t.w),t.h&&(e.height=t.h),t.color&&(e.fill=t.color),t.weight&&ecEditor._.includes(t.weight,"bold")?(e.fontWeight="bold",t.fontweight=!0):t.fontweight=!1,t.weight&&ecEditor._.includes(t.weight,"italic")?(e.fontStyle="italic",t.fontstyle=!0):t.fontstyle=!1,t.font&&(e.fontFamily=t.font,t.fontFamily=t.font),t.fontsize){var i=this.updateFontSize(t.fontsize,!0);e.fontSize=i,t.fontSize=i}return t.align&&(e.textAlign=t.align,e.align=t.align),t.rotate&&(e.angle=t.rotate),this.isV2Plugin()||delete e.lineHeight,e},getConfigManifest:function(){var t=this._super();return ecEditor._.remove(t,function(t){return"stroke"===t.propertyName}),t},showReadalong:function(){var t=this,e=ecEditor.getCurrentObject();ecEditor.dispatchEvent("org.ekstep.readalongbrowser:showpopup",{textObj:e,callback:t.convertTexttoReadalong})},convertTexttoReadalong:function(t){var e=ecEditor.getCurrentObject(),i=ecEditor.getPluginInstance(e.id);TextWYSIWYG.resetProperties(e),e.config.text=e.editorObj.text=t.text,e.config.audio=t.audio,e.config.timings=t.timings,e.config.highlight=t.highlight,e.config.audioObj=t.audioObj,e.config.autoplay=t.autoplay,e.attributes.autoplay=t.autoplay,e.attributes.textType="readalong",textEditor.hide();var o=t.audioObj;ecEditor._.isUndefined(o)||(o.src=org.ekstep.contenteditor.mediaManager.getMediaOriginURL(o.src)),e.addMedia(o),i.addReadalongconfigManifest(e),ecEditor.dispatchEvent("config:show"),ecEditor.render()},showWordInfo:function(){var t=this,e=ecEditor.getCurrentObject();ecEditor.dispatchEvent("org.ekstep.wordinfobrowser:showpopup",{textObj:e,callback:t.convertTexttoWordinfo})},convertTexttoWordinfo:function(t,e){var i=ecEditor.getCurrentObject(),o=ecEditor.getPluginInstance(i.id);TextWYSIWYG.resetProperties(i),i.data=e,i.config.text=i.editorObj.text=t.text,i.config.words=t.words,i.config.wordfontcolor=t.wordfontcolor,i.config.wordhighlightcolor=t.wordhighlightcolor,i.config.wordunderlinecolor=t.wordunderlinecolor,i.attributes.textType="wordinfo",i.addMedia({id:"org.ekstep.text.popuptint",src:ecEditor.resolvePluginResource(o.manifest.id,o.manifest.ver,"assets/popuptint.png"),type:"image",assetId:"org.ekstep.text.popuptint"}),o.addWordinfoconfigManifest(i),ecEditor.dispatchEvent("config:show"),ecEditor.render()},deleteEnhancement:function(){ecEditor.getService("popup").open({template:"deleteConfirmationDialog",controller:["$scope",function(t){t.warningMessage="readalong"==ecEditor.getCurrentObject().attributes.textType?"Read-Along":"Word Info Popup",t.delete=function(){t.closeThisDialog();var e=ecEditor.getCurrentObject();"readalong"==e.attributes.textType?(delete e.config.audio,delete e.config.timings,delete e.config.highlight,delete e.config.audioObj,delete e.config.autoplay,delete e.attributes.autoplay):(delete e.data,delete e.config.words,delete e.config.wordfontcolor,delete e.config.wordhighlightcolor,delete e.config.wordunderlinecolor),e.attributes.textType="text",ecEditor.dispatchEvent("config:show"),this.isV2Plugin()&&TextWYSIWYG.setInstance(this),ecEditor.render()}}],width:520,showClose:!1})},addReadalongconfigManifest:function(t){ecEditor.dispatchEvent("org.ekstep.text:addReadAlong",t)},addWordinfoconfigManifest:function(t){ecEditor.dispatchEvent("org.ekstep.text:addWordInfo",t)},getMedia:function(){var t=this;return"text"===t.attributes.textType?{}:t._super()},toECML:function(){var t=this._super();return t.textType!==this.constants.v2supportedText&&(t.lineHeight=this.constants.createJsLineHeight),t},fromECML:function(){this._super(this.editorData),this.attributes.textType!==this.constants.v2supportedText&&delete this.attributes.lineHeight},isV2Plugin:function(t){var e=t||this;return!(!e.attributes.version||"V2"!==e.attributes.version)}});'))
org.ekstep.pluginframework.pluginManager.registerPlugin({"id":"org.ekstep.shape","ver":"1.0","shortId":"shape","displayName":"Shape","author":"Santhosh Vasabhaktula","title":"Shape Plugin","description":"","publishedDate":"","editor":{"main":"editor/plugin.js","dependencies":[],"menu":[{"id":"shape","category":"main","type":"icon","toolTip":"Add Shapes","title":"Shapes","iconClass":"icon-shape icon","submenu":[{"id":"triangle","type":"icon","toolTip":"Add Triangle","title":"Triangle","iconClass":"icon-triangle icon","onclick":{"id":"org.ekstep.shape:create","data":{"type":"triangle","x":20,"y":20,"fill":"#00FF00","w":14,"h":25,"stroke":"rgba(255, 255, 255, 0)","strokeWidth":1,"opacity":1}}},{"id":"rectangle","type":"icon","toolTip":"Add Rectangle","title":"Rectangle","iconClass":"icon-rectangle icon","onclick":{"id":"org.ekstep.shape:create","data":{"type":"rect","x":10,"y":20,"fill":"#FFFF00","w":14,"h":25,"stroke":"rgba(255, 255, 255, 0)","strokeWidth":1,"opacity":1}}},{"id":"circle","type":"icon","toolTip":"Add Circle","title":"Circle","iconClass":"icon-circle icon","onclick":{"id":"org.ekstep.shape:create","data":{"type":"ellipse","x":15,"y":15,"fill":"#00FF00","w":18,"h":32,"stroke":"rgba(255, 255, 255, 0)","strokeWidth":1,"opacity":1}}},{"id":"rounded-rectangle","type":"icon","toolTip":"Add Rounded Rectangle","title":"Rounded Rectangle","iconClass":"icon-roundedrect icon","onclick":{"id":"org.ekstep.shape:create","data":{"type":"roundrect","x":20,"y":20,"fill":"#FF0000","w":14,"h":25,"radius":10,"stroke":"rgba(255, 255, 255, 0)","strokeWidth":1,"opacity":1}}},{"id":"star","type":"icon","toolTip":"Add Star","title":"Star","iconClass":"star icon","onclick":{"id":"org.ekstep.shape:create","data":{"type":"star","x":20,"y":20,"fill":"#FF0000","w":14,"h":25,"corners":5,"stroke":"rgba(255, 255, 255, 0)","strokeWidth":1,"opacity":1}}},{"id":"polygon","type":"icon","toolTip":"Add Polygon","title":"Polygon","iconClass":"first order icon","onclick":{"id":"org.ekstep.shape:create","data":{"type":"polygon","x":20,"y":20,"fill":"#FF0000","w":14,"h":25,"sides":5,"stroke":"rgba(255, 255, 255, 0)","strokeWidth":1,"opacity":1}}},{"id":"trapezium","type":"icon","toolTip":"Add Trapezium","title":"Trapezium","iconClass":"road icon","onclick":{"id":"org.ekstep.shape:create","data":{"type":"trapezium","x":20,"y":20,"fill":"#FF0000","w":14,"h":25,"stroke":"rgba(255, 255, 255, 0)","strokeWidth":1,"opacity":1}}},{"id":"rarrow","type":"icon","toolTip":"Add Arrow","title":"Arrow","iconClass":"long right arrow icon","onclick":{"id":"org.ekstep.shape:create","data":{"type":"rarrow","x":20,"y":20,"fill":"#000000","w":30,"h":25,"stroke":"rgba(255, 255, 255, 0)","strokeWidth":1,"opacity":1}}},{"id":"harrow","type":"icon","toolTip":"Add double arrow","title":"Double Arrow","iconClass":"resize horizontal icon","onclick":{"id":"org.ekstep.shape:create","data":{"type":"harrow","x":20,"y":20,"fill":"#000000","w":30,"h":25,"stroke":"rgba(255, 255, 255, 0)","strokeWidth":1,"opacity":1}}}]}],"behaviour":{"rotatable":true},"configManifest":[{"propertyName":"color","title":"Fill Color","description":"Choose a color from the color picker","dataType":"colorpicker","required":true,"defaultValue":"#000000"},{"propertyName":"opacity","title":"Transparency","description":"Set the transparency for element","dataType":"rangeslider","labelSuffix":"%","required":true,"defaultValue":100,"minimumValue":0,"maximumValue":100}],"help":{"src":"editor/help.md","dataType":"text"},"init-data":{"type":"rect","x":10,"y":20,"fill":"#FFFF00","w":14,"h":25}}},eval('org.ekstep.contenteditor.basePlugin.extend({type:"shape",_points:void 0,shapeType:void 0,initialize:function(){},newInstance:function(){var e=this.convertToFabric(this.attributes);switch(this.attributes.type){case"ellipse":e.rx=e.w/2,e.ry=e.h/2,this.shapeType="ellipse",this.editorObj=new fabric.Ellipse(e);break;case"roundrect":this.manifest.editor.configManifest.push({propertyName:"radius",title:"Radius",placeholder:"Radius",description:"Input radius for the rounded rectangle",dataType:"input",valueType:"number",required:!1,defaultValue:10,minimumValue:0}),this.shapeType="roundrect",this.editorObj=new fabric.Rect(e);break;case"rect":this.shapeType="rect","slidebackground"!==e.subtype&&(this.editorObj=new fabric.Rect(e));break;case"triangle":e.sides=3,this.shapeType="3polygon",this.drawShape(this.shapeType,e);break;case"star":this.manifest.editor.configManifest.push({propertyName:"corners",title:"Corners",placeholder:"Corners",description:"No of corners for the star",dataType:"rangeslider",valueType:"number",required:!1,defaultValue:5,minimumValue:4,maximumValue:10});var t=e.corners;this.shapeType=t+"star",this.drawShape(this.shapeType,e);break;case"polygon":this.manifest.editor.configManifest.push({propertyName:"sides",title:"Sides",placeholder:"Sides",description:"No of sides for the shape",dataType:"rangeslider",valueType:"number",required:!1,defaultValue:5,minimumValue:4,maximumValue:10});var s=e.sides;this.shapeType=s+"polygon",this.drawShape(this.shapeType,e);break;case"trapezium":this.shapeType="trapezium",this.drawShape(this.shapeType,e);break;case"rarrow":this.shapeType="rarrow",this.drawShape(this.shapeType,e);break;case"harrow":this.shapeType="harrow",this.drawShape(this.shapeType,e)}this.editorObj&&this.editorObj.setFill(e.fill)},onConfigChange:function(e,t){switch(e){case"color":this.editorObj.setFill(t),this.attributes.fill=t;break;case"radius":"ellipse"==this.attributes.type&&(this.editorObj.set({w:2*t}),this.editorObj.set({h:2*t}),this.attributes.w=2*t,this.attributes.h=2*t),this.editorObj.set({rx:t}),this.editorObj.set({ry:t}),this.attributes.radius=t;break;case"sides":var s=t;this.shapeType=s+"polygon";var i=this.shapes[this.shapeType];this.attributes.sides=s,this.editorObj.set({points:i});break;case"corners":var y=t;this.shapeType=y+"star";var i=this.shapes[this.shapeType];this.attributes.corners=y,this.editorObj.set({points:i})}ecEditor.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})},getConfig:function(){var e=this._super();return e.color=this.attributes.fill,"roundrect"==this.attributes.type&&(e.radius=this.editorObj.rx),"ellipse"==this.attributes.type&&(e.radius=this.editorObj.rx),this.attributes.corners&&(e.corners=this.attributes.corners),this.attributes.sides&&(e.sides=this.attributes.sides),e.points=this.shapes[this.shapeType],e},drawShape:function(e,t){this._points=_.cloneDeep(this.shapes[e]),this.toPixel(this._points),t.strokeLineJoin="bevil",this.editorObj=new fabric.Polygon(this._points,t)},toPixel:function(e){var t=this;return e&&e.forEach(function(e){e.x=t.attributes.w*e.x/100,e.y=t.attributes.h*e.y/100}),e},changed:function(e,t,s){"roundrect"==e.attributes.type&&(e.editorObj.setWidth(e.editorObj.getWidth()-e.editorObj.getStrokeWidth()),e.editorObj.setHeight(e.editorObj.getHeight()-e.editorObj.getStrokeWidth()),e.editorObj.setScaleX(1),e.editorObj.setScaleY(1))},shapes:{"4star":[{x:100,y:50},{x:62.7,y:62.7},{x:50,y:100},{x:37.3,y:62.7},{x:0,y:50},{x:37.3,y:37.3},{x:50,y:0},{x:62.7,y:37.3}],"5star":[{x:50,y:0},{x:60.9,y:35},{x:100,y:35},{x:67.6,y:60},{x:79.4,y:100},{x:50,y:72},{x:20.6,y:100},{x:32.4,y:60},{x:0,y:35},{x:39.1,y:35}],"6star":[{x:50,y:100},{x:35,y:76},{x:0,y:75},{x:20,y:50},{x:0,y:25},{x:35,y:24},{x:50,y:0},{x:65,y:24},{x:100,y:25},{x:80,y:50},{x:100,y:75},{x:65,y:76}],"7star":[{x:100,y:59.8},{x:74,y:68},{x:72.9,y:100},{x:50.8,y:80},{x:29.6,y:100},{x:27.1,y:69.4},{x:0,y:62.5},{x:20.6,y:44.1},{x:10,y:19.9},{x:36.2,y:23.3},{x:48.6,y:0},{x:62.3,y:22.6},{x:88.2,y:17.7},{x:79,y:42.5}],"8star":[{x:100,y:50},{x:82.3,y:63.4},{x:85.4,y:85.4},{x:63.4,y:82.3},{x:50,y:100},{x:36.6,y:82.3},{x:14.6,y:85.4},{x:17.7,y:63.4},{x:0,y:50},{x:17.7,y:36.6},{x:14.6,y:14.6},{x:36.6,y:17.7},{x:50,y:0},{x:63.4,y:17.7},{x:85.4,y:14.6},{x:82.3,y:36.6}],"9star":[{x:100,y:40.2},{x:84.6,y:55.3},{x:93.8,y:74},{x:73.1,y:76.3},{x:68.1,y:100},{x:50.8,y:85},{x:33.9,y:100},{x:28.1,y:77.3},{x:7.3,y:75.9},{x:15.7,y:56.8},{x:0,y:42.4},{x:19.3,y:33.2},{x:17,y:12.4},{x:37.3,y:17.4},{x:48.9,y:0},{x:61.3,y:16.9},{x:81.3,y:11},{x:79.9,y:31.8}],"10star":[{x:100,y:65.5},{x:78.3,y:70.6},{x:79.4,y:90.5},{x:60.8,y:83.3},{x:50,y:100},{x:39.2,y:83.3},{x:20.6,y:90.5},{x:21.7,y:70.6},{x:0,y:65.5},{x:15,y:50},{x:0,y:34.5},{x:21.7,y:29.4},{x:20.6,y:9.5},{x:39.2,y:16.7},{x:50,y:0},{x:60.8,y:16.7},{x:79.4,y:9.5},{x:78.3,y:29.4},{x:100,y:34.5},{x:85,y:50}],"3polygon":[{x:50,y:0},{x:100,y:100},{x:0,y:100}],"4polygon":[{x:50,y:0},{x:100,y:50},{x:50,y:100},{x:0,y:50}],"5polygon":[{x:50,y:0},{x:100,y:34.5},{x:79.4,y:100},{x:20.6,y:100},{x:0,y:34.5}],"6polygon":[{x:100,y:50},{x:75,y:100},{x:25,y:100},{x:0,y:50},{x:25,y:0},{x:75,y:0}],"7polygon":[{x:50,y:0},{x:89.1,y:18.8},{x:100,y:61.1},{x:71.7,y:100},{x:28.3,y:100},{x:0,y:61.1},{x:10.9,y:18.8}],"8polygon":[{x:100,y:69.1},{x:69.1,y:100},{x:30.9,y:100},{x:0,y:69.1},{x:0,y:30.9},{x:30.9,y:0},{x:69.1,y:0},{x:100,y:30.9}],"9polygon":[{x:50,y:0},{x:82.1,y:11.7},{x:100,y:41.3},{x:93.3,y:75},{x:67.1,y:100},{x:32.9,y:100},{x:6.7,y:75},{x:0,y:41.3},{x:17.9,y:11.7}],"10polygon":[{x:100,y:50},{x:90.5,y:79.4},{x:65.5,y:100},{x:34.5,y:100},{x:9.5,y:79.4},{x:0,y:50},{x:9.5,y:20.6},{x:34.5,y:0},{x:65.5,y:0},{x:90.5,y:20.6}],trapezium:[{x:25,y:0},{x:75,y:0},{x:100,y:100},{x:0,y:100}],rarrow:[{x:0,y:25},{x:75,y:25},{x:75,y:0},{x:100,y:50},{x:75,y:100},{x:75,y:75},{x:0,y:75}],harrow:[{x:0,y:50},{x:25,y:0},{x:25,y:25},{x:75,y:25},{x:75,y:0},{x:100,y:50},{x:75,y:100},{x:75,y:75},{x:25,y:75},{x:25,y:100}]}});'))
org.ekstep.pluginframework.pluginManager.registerPlugin({"id":"org.ekstep.image","ver":"1.1","shortId":"image","displayName":"Image","author":"Santhosh Vasabhaktula","title":"Image Plugin","description":"","publishedDate":"","editor":{"main":"editor/plugin.js","help":{"src":"editor/help.md","dataType":"text"},"dependencies":[{"type":"plugin","plugin":"org.ekstep.assetbrowser","ver":"1.2"}],"menu":[{"id":"image","category":"main","type":"icon","toolTip":"Add Image","title":"Image","iconClass":"fa fa-picture-o","onclick":{"id":"org.ekstep.image:assetbrowser:open"}}],"behaviour":{"rotatable":true},"configManifest":[{"propertyName":"imagebrowser","title":"Image Browser","description":"Choose a  from the browser","dataType":"browser","required":true,"onclick":{"id":"org.ekstep.assetbrowser:show","type":"image"}}]}},eval('org.ekstep.contenteditor.basePlugin.extend({name:"Image",initialize:function(){var t=this;ecEditor.addEventListener(t.manifest.id+":assetbrowser:open",this.openBrowser,this)},newInstance:function(){var t=this,e=this.parent;this.parent=void 0;var i=this.convertToFabric(this.attributes);"plugin"==this.attributes.from&&(delete i.width,delete i.height);var s=this.media?this.media[this.attributes.asset]:void 0;if(!s||!s.src)throw new Error("media source is missing!");if(s&&s.src){this.name=this.attributes.asset,s.src=ecEditor.getMediaReverseProxyURL(s.src);var r=ecEditor.getConfig("useProxyForURL")?"image/get/"+encodeURIComponent(s.src):s.src;fabric.Image.fromURL(r,function(s){s.strokeWidth=1,t.editorObj=s,t.parent=e,"plugin"==t.attributes.from&&(t.editorObj.scaleToWidth(i.w),delete t.attributes.from),t.postInit()},i)}},openBrowser:function(){var t=this;ecEditor.dispatchEvent("org.ekstep.assetbrowser:show",{type:"image",search_filter:{},callback:function(e){e.x=20,e.y=20,e.w=50,e.h=50,e.from="plugin",ecEditor.dispatchEvent(t.manifest.id+":create",e)}})},getCopy:function(){var t=this._super();return t.assetMedia=this.media[this.attributes.asset],t},onConfigChange:function(t,e){switch(t){case"browser":ecEditor.dispatchEvent("delete:invoke"),ecEditor.dispatchEvent(this.manifest.id+":create",e)}},getDisplayName:function(){return this.name}});'))
org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.audio-1.1/editor/libs/jquery.jplayer.min.js', 'js')
org.ekstep.pluginframework.pluginManager.registerPlugin({"id":"org.ekstep.hotspot","ver":"1.0","shortId":"hotspot","displayName":"Hotspot","author":"Santhosh Vasabhaktula","title":"Hotspot Plugin","description":"","publishedDate":"","editor":{"main":"editor/plugin.js","dependencies":[],"menu":[{"id":"hotspot","category":"main","type":"icon","toolTip":"Add Hotspot","title":"Hotspot","iconClass":"icon-hotspot icon","onclick":{"id":"org.ekstep.hotspot:create","data":{"type":"roundrect","y":20,"x":20,"fill":"rgb(255,0,0)","w":15,"h":25,"opacity":0.3,"stroke":"rgba(255, 255, 255, 0)","strokeWidth":1}}}],"behaviour":{"rotatable":true},"configManifest":[{"propertyName":"color","title":"Fill color","description":"Choose a color from the color picker","dataType":"colorpicker","required":true,"defaultValue":"rgb(255,0,0)"}],"help":{"src":"editor/help.md","dataType":"text"}},"initdata":{"props":{"y":20,"x":20}}},eval('org.ekstep.contenteditor.basePlugin.extend({type:"hotspot",initialize:function(){},newInstance:function(){this.attributes.opacity=ecEditor._.isUndefined(this.attributes.opacity)?.4:this.attributes.opacity;var t=this.convertToFabric(this.attributes);"roundrect"===this.attributes.type&&(this.editorObj=new fabric.Rect(t))},onRemove:function(t){},updateAttributes:function(){var t=this,i={"stroke-width":"stroke-width",scaleX:"scaleX",scaleY:"scaleY"};this&&(ecEditor._.forEach(i,function(i,e){t.attributes[e]=t.editorObj.get(i)}),this.attributes.radius=this.editorObj.rx)},onConfigChange:function(t,i){"color"===t&&(this.editorObj.setFill(i),this.attributes.fill=i),ecEditor.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})},getConfig:function(){var t=this._super();return t.opacity=100*this.attributes.opacity,t.color=this.attributes.fill,t}});'))
org.ekstep.pluginframework.pluginManager.registerPlugin({"id":"org.ekstep.audio","ver":"1.0","shortId":"audio","displayName":"Audio","author":"Amol Ghatol","title":"Audio Plugin","description":"","publishedDate":"","editor":{"main":"editor/plugin.js","dependencies":[{"type":"js","src":"editor/libs/jquery.jplayer.min.js"},{"type":"plugin","plugin":"org.ekstep.assetbrowser","ver":"1.2"}],"menu":[{"id":"audio","category":"main","type":"icon","toolTip":"Add Audio","title":"Audio","iconClass":"icon-audio icon","onclick":{"id":"org.ekstep.audio:assetbrowser:open"}}],"config":[{"propertyName":"aduioBrowser","title":"Audio Browser","description":"Choose a  from the browser","dataType":"audiobrowser","required":true}],"playable":true}},eval('org.ekstep.contenteditor.basePlugin.extend({audioData:void 0,name:void 0,initialize:function(){var e=this;ecEditor.addEventListener(e.manifest.id+":assetbrowser:open",this.openBrowser,this),ecEditor.addEventListener(e.manifest.id+":removeAudio",this.removeAudio,this),ecEditor.addEventListener(e.manifest.id+":toggleAudio",this.toggleAudio,this),ecEditor.addEventListener(e.manifest.id+":jplayerInit",this.jplayerInit,this)},newInstance:function(){var e=this,t=this.media?this.media[this.attributes.asset]:void 0;t&&t.src?(t.src=org.ekstep.contenteditor.mediaManager.getMediaOriginURL(t.src),this.addMedia(t),this.audioData={stageId:ecEditor.getCurrentStage().id,type:"audio",title:ecEditor._.isUndefined(t.name)?t.id:t.name,assetId:t.id,id:e.id,url:t.src},this.name=this.audioData.title,ecEditor.dispatchEvent("org.ekstep.stageconfig:addcomponent",this.audioData)):this.parent=void 0},openBrowser:function(){var e=this;ecEditor.dispatchEvent("org.ekstep.assetbrowser:show",{type:"audio",search_filter:{},callback:function(t){ecEditor.dispatchEvent(e.manifest.id+":create",t)}})},getCopy:function(){var e=this._super();return e.assetMedia=this.media[this.attributes.asset],e},onConfigChange:function(e,t){ecEditor.dispatchEvent("delete:invoke"),ecEditor.dispatchEvent(this.manifest.id+":create",t)},render:function(e){},removeAudio:function(e,t){ecEditor.getPluginInstance(t.id).remove(),ecEditor.dispatchEvent("org.ekstep.stageconfig:remove",t)},toggleAudio:function(e,t){ecEditor.getPluginInstance(t.id).config.autoplay=t.autoplay,ecEditor.dispatchEvent("org.ekstep.config:toggleStageEvent",{flag:t.autoplay,id:t.assetId})},jplayerInit:function(e,t){var i=t.id;ecEditor.jQuery("#"+i).jPlayer({swfPath:"js/jplayer/",supplied:"mp3",solution:"html, flash",preload:"auto",wmode:"window",ready:function(){ecEditor.jQuery(this).jPlayer("setMedia",{mp3:t.url}).jPlayer("play")},play:function(){ecEditor.jQuery(this).addClass("pause")},pause:function(){ecEditor.jQuery(this).removeClass("pause")},stop:function(){ecEditor.jQuery(this).removeClass("pause")}}),ecEditor.jQuery("#"+i).hasClass("pause")?ecEditor.jQuery("#"+i).jPlayer("pause"):ecEditor.jQuery("#"+i).jPlayer("play")},getDisplayName:function(){return this.name}});'))
org.ekstep.pluginframework.pluginManager.registerPlugin({"id":"org.ekstep.scribblepad","ver":"1.0","author":"Santhosh Vasabhaktula","title":"Scribblepad Plugin","description":"","displayName":"Scribble","publishedDate":"","editor":{"main":"editor/plugin.js","dependencies":[],"menu":[{"id":"scribblepad","category":"main","type":"icon","toolTip":"Add Scribblepad","title":"scribblepad","iconClass":"icon-scribble icon","onclick":{"id":"org.ekstep.scribblepad:create","data":{"type":"roundrect","y":20,"x":25,"fill":"#3399FF","w":27,"h":60,"stroke":"rgba(255, 255, 255, 0)","strokeWidth":2,"opacity":0.3}},"media":[{"id":"eraserImage","src":"assets/EraserImage.png","type":"image"}]}],"configManifest":[{"propertyName":"color","title":"Fill color","description":"Choose a color from the color picker","dataType":"colorpicker","required":true,"defaultValue":"#3399FF"},{"propertyName":"opacity","title":"Transparency","description":"Set the transparency for element","dataType":"rangeslider","labelSuffix":"%","required":true,"minimumValue":0,"maximumValue":100}],"help":{"src":"editor/help.md","dataType":"text"}},"renderer":{"main":"renderer/scribblepadplugin.js"}},eval('org.ekstep.contenteditor.basePlugin.extend({type:"org.ekstep.scribblepad",initialize:function(){},newInstance:function(){var t=this.convertToFabric(this.attributes);t.stroke=this.attributes.stroke,t.strokeWidth=this.attributes.strokeWidth,t.fill=this.attributes.fill,"roundrect"===this.attributes.type&&(this.editorObj=new fabric.Rect(t),this.addMedia({id:"org.ekstep.scribblepad.eraser",src:"/assets/public/content/1460624453530trash.png",assetId:"org.ekstep.scribblepad.eraser",type:"image",preload:!0}))},updateAttributes:function(){var t=this,e={radius:"radius",opacity:"opacity",stroke:"stroke","stroke-width":"stroke-width",scaleX:"scaleX",scaleY:"scaleY"};t&&ecEditor._.forEach(e,function(e,i){t.attributes[i]=t.editorObj.get(e)})},onConfigChange:function(t,e){"color"===t&&(this.editorObj.setFill(e),this.attributes.fill=e),ecEditor.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})},getAttributes:function(){var t=this._super();return delete t.strokeDashArray,t["stroke-width"]=1,t.thickness=2,t},getConfig:function(){var t=this._super();return t.color=this.attributes.fill,t.opacity=100*this.attributes.opacity,t}});'))
org.ekstep.pluginframework.pluginManager.registerPlugin({"id":"org.ekstep.stageconfig","ver":"1.0","author":"Sunil","title":"Stage Config","description":"","publishedDate":"","editor":{"main":"editor/plugin.js"}},eval('org.ekstep.contenteditor.basePlugin.extend({type:"org.ekstep.stageconfig",stageAudios:{},scope:ecEditor.getAngularScope(),initialize:function(){ecEditor.addEventListener(this.manifest.id+":addcomponent",this.register,this),ecEditor.addEventListener("stage:render:complete",this.stageRender,this),ecEditor.addEventListener(this.manifest.id+":remove",this.removeAudio,this)},register:function(t,e){this.stageAudios[e.stageId]||(this.stageAudios[e.stageId]=[]),this.stageAudios[e.stageId].push(e),this.showComponents(e.stageId)},getStageIndex:function(t){return ecEditor._.findIndex(this.stageConfig,function(e){return t.stageId===e.stageId})},addComponents:function(t){var e=this,s=ecEditor.getStagePluginInstances(t,["org.ekstep.audio"]);s.length&&(this.stageAudios[t]=this.stageAudios[t]?this.stageAudios[t]:[]),_.each(s,function(s){e.stageAudios[t].push(s.audioData)})},stageRender:function(t,e){this.showComponents(e.stageId)},showComponents:function(t){this.stageAudios[t]||this.addComponents(t);var e=this;this.hideStageComponents(t),setTimeout(function(){e.showStageComponents(t)},500);var e=this;ecEditor.ngSafeApply(e.scope,function(){e.scope.currentStage=ecEditor.getCurrentStage()})},showStageComponents:function(t){var e=this,s=[];ecEditor._.forEach(this.stageAudios[t],function(t){var e=ecEditor.getPluginInstance(t.id);t.autoplay=e.config.autoplay,s.push(t)}),ecEditor.ngSafeApply(e.scope,function(){e.scope.stageAttachments.audio={},e.scope.stageAttachments.audio.items=s,e.scope.stageAttachments.audio.show=!0})},hideStageComponents:function(t){var e=this;ecEditor.ngSafeApply(e.scope,function(){e.scope.stageAttachments.audio={},e.scope.stageAttachments.audio.items=[],e.scope.stageAttachments.audio.show=!1})},removeAudio:function(t,e){this.stageAudios[e.stageId]=ecEditor._.reject(this.stageAudios[e.stageId],{id:e.id}),this.showComponents(e.stageId)}});'))
org.ekstep.pluginframework.pluginManager.registerPlugin({"id":"org.ekstep.telemetry","ver":"1.0","author":"Sunil A S","title":"Telemetry Plugin","description":"","publishedDate":"","editor":{"main":"editor/plugin.js"}},eval('org.ekstep.contenteditor.basePlugin.extend({type:"org.ekstep.telemetry",service:void 0,initialize:function(){this.service=ecEditor.getService("telemetry"),ecEditor.addEventListener("content:load:complete",this.registerEvents,this),ecEditor.addEventListener("content:load:complete",this.logPluginErrors,this)},registerEvents:function(){var e=this;ecEditor.addEventListener("object:selected",function(t,i){i&&i.id&&""!=i.id&&e.interactEvent("select","","plugin",i.type,i.ver,i.id)},this),ecEditor.addEventListener("object:modified",function(t,i){i&&i.id&&""!=i.id&&e.interactEvent("modify","","plugin",i.type,i.ver,i.id)},this),ecEditor.addEventListener("object:unselected",function(t,i){i&&i.id&&""!=i.id&&e.interactEvent("unselect","","plugin",i.type,i.ver,i.id)},this),ecEditor.addEventListener("object:removed",function(t,i){if(i&&i.id&&""!=i.id){var n=ecEditor.getPluginInstance(i.id);e.service.pluginLifeCycle({type:"remove",pluginid:n.manifest.id,pluginver:n.manifest.ver,objectid:n.id,assetid:n.getAttribute("asset"),stage:ecEditor.getCurrentStage().id,containerid:"",containerplugin:""})}},this),ecEditor.addEventListener("stage:removed",function(t,i){if(i&&i.stageId&&""!=i.stageId){var n=ecEditor.getPluginInstance(i.stageId);e.service.pluginLifeCycle({type:"remove",pluginid:n.manifest.id,pluginver:n.manifest.ver,objectid:n.id,assetid:n.getAttribute("asset"),stage:n.id,containerid:"",containerplugin:""})}},this),ecEditor.addEventListener("stage:delete",function(t,i){i&&i.stageId&&""!=i.stageId&&e.interactEvent("click","delete","plugin","org.ekstep.stage","1.0",i.stageId)},this),ecEditor.addEventListener("stage:duplicate",function(t,i){i&&i.stageId&&""!=i.stageId&&e.interactEvent("duplicate","","plugin","org.ekstep.stage","1.0",i.stageId)},this),ecEditor.addEventListener("stage:select",function(t,i){i&&i.stageId&&""!=i.stageId&&e.interactEvent("select","","plugin","org.ekstep.stage","1.0",i.stageId)},this),ecEditor.addEventListener("stage:reorder",function(t,i){i&&i.stageId&&""!=i.stageId&&e.interactEvent("modify","reorder","stage","org.ekstep.stage","1.0",i.stageId)},this),ecEditor.addEventListener("plugin:load",function(t,i){i&&e.service.pluginLifeCycle({type:"load",pluginid:i.plugin,pluginver:i.version,objectid:"",stage:"",containerid:"",containerplugin:""})},this),ecEditor.addEventListener("plugin:add",function(t,i){var n=ecEditor.getCurrentStage()?ecEditor.getCurrentStage().id:"";i&&e.service.pluginLifeCycle({type:"add",pluginid:i.plugin,pluginver:i.version,objectid:i.instanceId,stage:n,containerid:"",containerplugin:""})},this),ecEditor.addEventListener("plugin:error",function(t,i){var n=ecEditor.getService("content").getContentMeta(org.ekstep.contenteditor.api.getContext("contentId")).pkgVersion,r={id:org.ekstep.contenteditor.api.getContext("contentId"),ver:!_.isUndefined(n)&&n.toString()||"0",type:"Content"};e.service.error({err:i.err,errtype:"CONTENT",stacktrace:i.stackTrace||"",object:r,plugin:{id:i.plugin,ver:i.version,category:""}})},this)},interactEvent:function(e,t,i,n,r,d){this.service.interact({type:e,subtype:t,target:i,pluginid:n,pluginver:r,objectid:d,stage:ecEditor.getCurrentStage().id})},logPluginErrors:function(e,t){var i=this,n=ecEditor.getService("content").getContentMeta(org.ekstep.contenteditor.api.getContext("contentId")).pkgVersion,r={id:org.ekstep.contenteditor.api.getContext("contentId"),ver:!_.isUndefined(n)&&n.toString()||"0",type:"Content"},d=org.ekstep.pluginframework.pluginManager.getErrors();_.each(d,function(e){i.service.error({err:e.error,errtype:"CONTENT",stacktrace:e.stackTrace||"",object:r,plugin:{id:e.plugin,ver:e.version,category:""}})})}});'))
org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.activitybrowser-1.3/editor/plugin.css', 'css')
org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.activitybrowser-1.3/editor/libs/angular-inview.js', 'js')
org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.activitybrowser-1.3/editor/camelize.js', 'js')
org.ekstep.pluginframework.pluginManager.registerPlugin({"id":"org.ekstep.activitybrowser","ver":"1.3","author":"Archana Baskaran","title":"Activity Browser Plugin","description":"","publishedDate":"","editor":{"main":"editor/plugin.js","dependencies":[{"type":"css","src":"editor/plugin.css"},{"type":"js","src":"editor/libs/angular-inview.js"},{"type":"js","src":"editor/camelize.js"}],"views":[{"template":"./activityBrowser.html","controller":"./activityBrowser.js"}],"menu":[{"id":"activitybrowser","category":"main","type":"icon","toolTip":"Add Activity","title":"Activity Browser","iconClass":"fa fa-magic","onclick":{"id":"org.ekstep.activitybrowser:showpopup"}}],"configManifest":[]}},eval('org.ekstep.contenteditor.basePlugin.extend({currentInstance:void 0,initialize:function(){var e=this;ecEditor.addEventListener("org.ekstep.activitybrowser:showpopup",this.loadBrowser,this);var t=ecEditor.resolvePluginResource(e.manifest.id,e.manifest.ver,"editor/activityBrowser.html"),r=ecEditor.resolvePluginResource(e.manifest.id,e.manifest.ver,"editor/activityBrowser.js");ecEditor.getService("popup").loadNgModules(t,r)},newInstance:function(){},loadBrowser:function(){currentInstance=this,ecEditor.getService("popup").open({template:"activityBrowser",controller:"activityBrowserCtrl",controllerAs:"$ctrl",resolve:{instance:function(){return currentInstance}},width:900,showClose:!1,className:"ngdialog-theme-plain"},function(){})}});'))
org.ekstep.pluginframework.pluginManager.registerPlugin({"id":"org.ekstep.collaborator","ver":"1.1","author":"Gourav More","title":"collaborator","description":"","publishedDate":"","editor":{"main":"editor/plugin.js","menu":[],"views":[{"template":"./popup.html","controller":""}]}},eval('org.ekstep.contenteditor.basePlugin.extend({type:"collaborator",isCollaboratorPopupOpened:!1,initialize:function(){ecEditor.addEventListener("collaborator:add",this.addCollaborator,this);var e=ecEditor.resolvePluginResource(this.manifest.id,this.manifest.ver,"editor/popup.html");ecEditor.getService("popup").loadNgModules(e)},addCollaborator:function(e,o){this.showPreview(function(){ecEditor.jQuery("#colUsersDropdown").dropdown({apiSettings:{url:ecEditor.getConfig("baseURL")+"/index.php?option=com_ekcontent&task=contentform.getUsersToInvite&id="+window.context.id+"&isEditor=true&search={query}",cache:!0},saveRemoteData:!0,fields:{remoteValues:"results",values:"values",name:"name",text:"text",value:"value"},minCharacters:1,forceSelection:!1})}),this.collaboratorsInfo()},showPreview:function(e){var o=this,t=function(t){t.getUrlLink=o.getUrlLink,t.viewContentLink=window.context.viewContentLink,t.sendInvites=o.sendInvites,o.copyAnswer="Copy",t.copyAnswer=o.copyAnswer,t.notifyUser=o.notifyUser,t.contentId=window.context.id,t.collaborators=o.collaborators,t.loading=o.loading,t.isLoading=o.isLoading,t.isError=o.isError,t.$on("ngDialog.opened",function(t,r){o.isCollaboratorPopupOpened=!0,e()})};ecEditor.getService("popup").open({template:"partials_org.ekstep.collaborator.html",controller:["$scope",t],showClose:!1,width:900,className:"ngdialog-theme-default"},function(){isCollaboratorPopupOpened=!1})},getUrlLink:function(){var e=this;ecEditor.jQuery("#copyTarget").select();try{var o=document.execCommand("copy");e.copyAnswer=o?"Copied!":"Unable to copy!"}catch(o){e.copyAnswer="Unsupported Browser!"}},sendInvites:function(){var e=this;ecEditor.jQuery("#colInviteForm").form({inline:!0,fields:{inviteUsers:{identifier:"inviteUsers",rules:[{type:"empty",prompt:"Please select usernames"}]},invite_msg:{identifier:"invite_msg",rules:[{type:"empty",prompt:"Invite message should not be blank"}]}},onSuccess:function(o,t){e.notifyUser(o,t)},onFailure:function(e,o){return console.log("fields validation failed"),!1}})},notifyUser:function(e,o){var t=this;ecEditor.jQuery.ajax({url:ecEditor.getConfig("baseURL")+"/index.php?option=com_ekcontent&task=contentform.inviteUsers",headers:{"x-auth":"session"},type:"POST",data:o,async:!1,beforeSend:function(){t.loading="active",t.isLoading=!0,t.isError=!1,ecEditor.ngSafeApply(ecEditor.getAngularScope())},success:function(e){1==e?(t.isLoading=!1,ecEditor.jQuery(".collaborator_msg").transition("drop"),ecEditor.ngSafeApply(ecEditor.getAngularScope())):(t.isError=!0,ecEditor.jQuery(".collaborator_msg").transition("drop"),ecEditor.ngSafeApply(ecEditor.getAngularScope()))},error:function(){console.log("Error")}})},collaboratorsInfo:function(){var e=this;ecEditor.jQuery.ajax({url:ecEditor.getConfig("baseURL")+"/index.php?option=com_api&app=ekcontent&resource=collaborator&format=raw",headers:{"x-auth":"session"},type:"GET",data:{id:window.context.id},async:!1,success:function(o){e.collaborators=o?o.result.collaborators:null},error:function(){console.log("Error")}})},generateTelemetry:function(e){var o=this;e&&ecEditor.getService("telemetry").interact({type:e.type,subtype:e.subtype,id:e.target,pageid:org.ekstep.contenteditor.api.getCurrentStage().id||"",target:{id:e.targetid||"",type:"plugin",ver:""},plugin:{id:o.manifest.id,ver:o.manifest.ver,category:"core"},ver:"3.0"})}});'))
org.ekstep.pluginframework.pluginManager.registerPlugin({"id":"org.ekstep.download","ver":"1.0","author":"Gourav More","title":"download","description":"","publishedDate":"","editor":{"main":"editor/plugin.js","menu":[],"views":[{"template":"./popup.html","controller":""}]}},eval('org.ekstep.contenteditor.basePlugin.extend({type:"download",initialize:function(){ecEditor.addEventListener("download:content",this.downloadContent,this);var e=ecEditor.resolvePluginResource(this.manifest.id,this.manifest.ver,"editor/popup.html");ecEditor.getService("popup").loadNgModules(e)},downloadContent:function(){var e=this;e.isSending="active",e.isLoading=!1,e.isSuccess=!1,e.isDownloading=!0;var t=function(t){t.isSending=e.isSending,t.isLoading=e.isLoading,t.isSuccess=e.isSuccess,t.isDownloading=e.isDownloading,t.cntName=ecEditor.getService("content").getContentMeta(ecEditor.getContext("contentId")).name,e.getDownloadUrl(function(o){o?(t.isLoading=!0,t.isDownloading=!1,ecEditor.ngSafeApply(ecEditor.getAngularScope()),e.sendEmail(t,o)):(t.isLoading=!1,t.isDownloading=!1,t.status=!1,t.getMessage="Content is not ready to download, please try again later",ecEditor.jQuery(".ct_download_msg").transition("drop"),ecEditor.ngSafeApply(ecEditor.getAngularScope()))})};ecEditor.getService("popup").open({template:"partials_org.ekstep.download.html",controller:["$scope",t],showClose:!1,width:900,background:"transparent!important",className:"ngdialog-theme-plain dwContent"})},getDownloadUrl:function(e){var t=ecEditor.getService("content").getContentMeta(ecEditor.getContext("contentId")).name.toLowerCase();ecEditor.getService("content").downloadContent(ecEditor.getContext("contentId"),t,function(t,o){e(t||"OK"!=o.data.responseCode?!1:o.data.result.ECAR_URL)})},sendEmail:function(e,t){ecEditor.jQuery.ajax({url:ecEditor.getConfig("baseURL")+"/index.php?option=com_api&app=ekcontent&resource=download&format=raw",headers:{"x-auth":"session"},type:"POST",data:{downloadUrl:t,name:ecEditor.getService("content").getContentMeta(ecEditor.getContext("contentId")).name},success:function(t){e.isLoading=!1,e.status="OK"==t.responseCode,e.getMessage=t.result,ecEditor.jQuery(".ct_download_msg").transition("drop"),ecEditor.ngSafeApply(ecEditor.getAngularScope())},error:function(){e.isLoading=!1,e.status=!1,e.getMessage="Unable to send email, please try again later",ecEditor.jQuery(".ct_download_msg").transition("drop"),ecEditor.ngSafeApply(ecEditor.getAngularScope())}})}});'))
org.ekstep.pluginframework.pluginManager.registerPlugin({"id":"org.ekstep.unsupported","ver":"1.0","author":"Harish Kumar Gangula","title":"Unsupported Plugin","description":"This plugin is fallback to the other plugins","publishedDate":"","editor":{"main":"editor/plugin.js","menu":[],"help":{"src":"editor/help.md","dataType":"text"}}},eval('org.ekstep.contenteditor.basePlugin.extend({type:"unsupported",initialize:function(){ecEditor.addEventListener("unsupported:invoke",this.showUnsupported,this)},props:{x:0,y:0,w:40,h:40,r:0},hasDims:!1,newInstance:function(){var t=this,i=this.parent;this.parent=void 0;var a=this.setImageDimensions(this.data.data),e=ecEditor.getConfig("absURL")+ecEditor.resolvePluginResource(this.manifest.id,this.manifest.ver,"assets/unsupportedplugin.png");fabric.Image.fromURL(e,function(a){t.editorObj=a,t.parent=i,t.postInit()},a)},setImageDimensions:function(t){var i=_.clone(this.props);return _.has(t,["x"])&&_.has(t,["w"])&&(this.attributes.x=i.x=t.x,this.attributes.y=i.y=t.y,this.attributes.w=i.w=t.w,this.attributes.h=i.h=t.h,this.percentToPixel(this.attributes),this.hasDims=!0),this.percentToPixel(i),this.convertToFabric(i)},fromECML:function(t){t.data.id=t.data.id||t.data.pluginId,this.setData(t.data)},toECML:function(){if(this.hasDims){var t=_.clone(this.attributes);this.pixelToPercent(t),this.data.data.x=t.x,this.data.data.y=t.y,this.data.data.w=t.w,this.data.data.h=t.h}return this.data.data},getCopy:function(){var t=this;return{data:{data:_.cloneDeep(this.toECML()),pluginId:t.data.id}}},getConfig:function(){},getAttributes:function(){},getManifestId:function(){return this.data.id}});'))
org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.wordinfobrowser-1.0/editor/plugin.css', 'css')
org.ekstep.pluginframework.pluginManager.registerPlugin({"id":"org.ekstep.wordinfobrowser","ver":"1.0","shortId":"wordinfobrowser","author":"Kartheek Palla","title":"Add Word Info Popup","description":"","publishedDate":"","editor":{"main":"editor/plugin.js","help":{"src":"editor/help.md","dataType":"text"},"dependencies":[{"type":"css","src":"editor/plugin.css"}],"views":[{"template":"./wordinfobrowser.html","controller":"./wordinfobrowserapp.js"}],"configManifest":[{"propertyName":"color","title":"Font color","description":"Choose a color from the color picker","dataType":"colorpicker","required":true,"defaultValue":"rgb(255,0,0)"},{"propertyName":"font","dataType":"group","description":"Choose fontweight and fontstyle","config":[{"propertyName":"fontweight","title":"Font Weight","toolTip":"Bold","description":"Select font size for the text","dataType":"icon","iconClass":"bold icon","required":true,"defaultValue":false},{"propertyName":"fontstyle","title":"Font Style","toolTip":"Italic","description":"Select font style for the text","dataType":"icon","iconClass":"italic icon","required":true,"defaultValue":false}]},{"propertyName":"fontfamily","title":"Font Family","description":"Select font family for the text","dataType":"select","range":["Arial","Courier","Georgia","Helvetica","Monospace","Sans-serif","Serif","Tahoma","Times","Trebuchet MS","Verdana","NotoSansKannada","NotoSansGujarati","NotoSansBengali","NotoSansGurmukhi","NotoSansOriya","NotoSansDevanagari","NotoSansTamil","NotoSansTelugu","NotoNastaliqUrdu","NotoSansMalayalam"],"required":true,"defaultValue":"Sans-serif"},{"propertyName":"fontsize","title":"Font Size","description":"Select font size for the text","dataType":"select","range":[18,20,22,24,26,28,32,36,40,44,48,54,60,66,72,80,88,96],"required":true,"defaultValue":18},{"propertyName":"wordfontcolor","title":"Word Font Color","description":"Choose a color from the color picker to highlight the font color of selected word","dataType":"colorpicker","required":true,"defaultValue":"#0000FF"},{"propertyName":"wordhighlightcolor","title":"Word Highlight Color","description":"Choose a color from the color picker to highlight the selected word","dataType":"colorpicker","required":true,"defaultValue":"#FFFF00"},{"propertyName":"wordunderlinecolor","title":"Word underline Color","description":"Choose a color from the color picker to underline the selected word","dataType":"colorpicker","required":true,"defaultValue":"#0000FF"}]}},eval('org.ekstep.contenteditor.basePlugin.extend({type:"wordinfobrowser",currentInstance:void 0,cb:void 0,text:void 0,initialize:function(){var e=this;ecEditor.addEventListener("object:unselected",this.objectUnselected,this),ecEditor.addEventListener("delete:invoked",this.deleteObject,this),ecEditor.addEventListener(e.manifest.id+":showpopup",this.loadHtml,this),setTimeout(function(){var t=ecEditor.resolvePluginResource(e.manifest.id,e.manifest.ver,"editor/wordinfobrowser.html"),i=ecEditor.resolvePluginResource(e.manifest.id,e.manifest.ver,"editor/wordinfobrowserapp.js");ecEditor.getService("popup").loadNgModules(t,i)},1e3)},loadHtml:function(e,t){currentInstance=this,this.cb=t.callback,this.attributes=t.textObj.attributes,this.config=t.textObj.config,"wordinfo"==t.textObj.attributes.textType&&(this.editorObj=t.textObj.editorObj),ecEditor.getService("popup").open({template:"wordinfobrowser",controller:"wordinfobrowsercontroller",controllerAs:"$ctrl",resolve:{instance:function(){return currentInstance}},width:900,showClose:!1,className:"ngdialog-theme-plain"},function(){})}});'))
org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.viewecml-1.0/editor/libs/dist/E2EConverter.js', 'js')
org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.viewecml-1.0/editor/libs/prism/prism.css', 'css')
org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.viewecml-1.0/editor/libs/prism/prism.js', 'js')
org.ekstep.pluginframework.pluginManager.registerPlugin({"id":"org.ekstep.viewecml","ver":"1.0","author":"Anshu Narayan","title":"viewecml Plugin","description":"","publishedDate":"","editor":{"main":"editor/plugin.js","dependencies":[{"type":"js","src":"editor/libs/dist/E2EConverter.js"},{"type":"css","src":"editor/libs/prism/prism.css"},{"type":"js","src":"editor/libs/prism/prism.js"}],"views":[{"template":"./ECMLbrowser.html","controller":""}],"menu":[{}]}},eval('org.ekstep.contenteditor.basePlugin.extend({type:"viewecml",callback:function(){},initialize:function(){Prism.plugins.NormalizeWhitespace.setDefaults({"break-lines":80}),converter=new E2EConverter,ecEditor.addEventListener(this.manifest.id+":show",this.initViewECML,this);var e=ecEditor.resolvePluginResource(this.manifest.id,this.manifest.ver,"editor/ECMLbrowser.html");setTimeout(function(){ecEditor.getService("popup").loadNgModules(e)},1e3)},initViewECML:function(e,t){var o=this;this.callback=t,this.loadResource("editor/ECMLbrowser.html","html",function(e,t){o.showECMLBrowser(e,t)})},showECMLBrowser:function(e,t){var o=this;ecEditor.getService("popup").open({template:"partials_org.ekstep.ECMLbrowser.html",controller:["$scope",o.controllerCallback],controllerAs:"$ctrl",showClose:!1,width:900,className:"ngdialog-theme-plain"})},controllerCallback:function(e,t){var o=this;o.contentBody="ECML Content",o.previewLoad=function(){var t=org.ekstep.contenteditor.stageManager.toECML();ecEditor.getAngularScope().developerMode&&(t.theme["plugin-manifest"]||(t.theme["plugin-manifest"]={plugin:[]}),_.isArray(t.theme["plugin-manifest"].plugin)||(t.theme["plugin-manifest"].plugin=[t.theme["plugin-manifest"].plugin]),t.theme["plugin-manifest"].plugin.splice(0,0,{id:"org.ekstep.developer",ver:"1.0",type:"plugin",hostPath:org.ekstep.pluginframework.hostRepo.basePath,preload:!0})),o.contentBody=converter.buildECML(t,!0),e.$safeApply(function(){setTimeout(function(){Prism.highlightElement(ecEditor.jQuery("#xmlBody")[0])},100)})},o.previewLoad(),o.copyToClipboard=function(e){var t,o,n=document.getElementById(e),i="INPUT"===n.tagName||"TEXTAREA"===n.tagName;if(i)l=n,t=n.selectionStart,o=n.selectionEnd;else{if(!(l=document.getElementById("_hiddenCopyText_"))){var l=document.createElement("textarea");l.style.position="absolute",l.style.left="-9999px",l.style.top="0",l.id="_hiddenCopyText_",document.body.appendChild(l)}l.textContent=n.textContent}var r=document.activeElement;l.focus(),l.setSelectionRange(0,l.value.length),console.log(l);var s;try{s=document.execCommand("copy"),window.alert("Copied!")}catch(e){s=!1}return r&&"function"==typeof r.focus&&r.focus(),i?n.setSelectionRange(t,o):l.textContent="",s},o.closeWindow=function(){e.closeThisDialog()}}});'))
org.ekstep.pluginframework.pluginManager.registerPlugin({"id":"org.ekstep.utils","ver":"1.0","author":"HarishKumar Gangula","title":"Utils Plugin","description":"This plugin is used to add utilitites","publishedDate":"","editor":{"main":"editor/plugin.js","menu":[{"id":"copy","category":"context","type":"icon","toolTip":"copy","title":"copy","iconClass":"copy icon","state":"HIDE","onclick":{"id":"copy:copyItem","data":{}}},{"id":"paste","category":"context","type":"icon","toolTip":"paste","title":"paste","iconClass":"paste icon","state":"HIDE","onclick":{"id":"paste:pasteItem","data":{}}},{"id":"delete","category":"context","type":"icon","toolTip":"Delete","title":"Delete","iconClass":"trash outline icon","state":"HIDE","onclick":{"id":"delete:invoke","data":{}}},{"id":"reorder","category":"context","type":"icon","toolTip":"Arrange","title":"Arrange","iconClass":"icon-arrange icon","state":"HIDE","submenu":[{"id":"bringforward","category":"context","type":"icon","toolTip":"Bring forward","title":"Bring forward","iconClass":"icon-bringforward icon","onclick":{"id":"reorder:bringforward","data":{}}},{"id":"bringfront","category":"context","type":"icon","toolTip":"Bring to front","title":"Bring to front","iconClass":"icon-bringfront icon","onclick":{"id":"reorder:bringfront","data":{}}},{"id":"sendbackward","category":"context","type":"icon","toolTip":"Send backward","title":"Send backward","iconClass":"icon-sendbackward icon","onclick":{"id":"reorder:sendbackward","data":{}}},{"id":"sendback","category":"context","type":"icon","toolTip":"Send to back","title":"Send to back","iconClass":"icon-sendback icon","onclick":{"id":"reorder:sendback","data":{}}}]}]}},eval('org.ekstep.contenteditor.basePlugin.extend({type:"utils",picker:void 0,clipboard:void 0,activeGroup:void 0,initialize:function(){ecEditor.addEventListener("reorder:bringforward",this.bringforward,this),ecEditor.addEventListener("reorder:bringfront",this.bringfront,this),ecEditor.addEventListener("reorder:sendbackward",this.sendbackward,this),ecEditor.addEventListener("reorder:sendback",this.sendback,this),ecEditor.addEventListener("copy:copyItem",this.copyItem,this),ecEditor.addEventListener("paste:pasteItem",this.pasteItem,this),ecEditor.addEventListener("delete:invoke",this.deleteObject,this),ecEditor.addEventListener("object:selected",this.objectSelected,this),ecEditor.addEventListener("object:unselected",this.objectUnSelected,this)},bringfront:function(e,t){ecEditor.getCanvas().bringToFront(ecEditor.getEditorObject()),ecEditor.render(),ecEditor.dispatchEvent("object:modified",{id:ecEditor.getEditorObject().id})},sendback:function(e,t){ecEditor.getCanvas().sendToBack(ecEditor.getEditorObject()),ecEditor.render(),ecEditor.dispatchEvent("object:modified",{id:ecEditor.getEditorObject().id})},bringforward:function(e,t){ecEditor.getCanvas().bringForward(ecEditor.getEditorObject()),ecEditor.render(),ecEditor.dispatchEvent("object:modified",{id:ecEditor.getEditorObject().id})},sendbackward:function(e,t){ecEditor.getCanvas().sendBackwards(ecEditor.getEditorObject()),ecEditor.render(),ecEditor.dispatchEvent("object:modified",{id:ecEditor.getEditorObject().id})},copyItem:function(){this.clipboard=_.cloneDeep(ecEditor.getCurrentObject()?ecEditor.getCurrentObject():ecEditor.getCurrentGroup()),this.activeGroup=ecEditor.getCanvas().getActiveGroup()&&ecEditor.getCanvas().getActiveGroup().getObjects(),this.clipboard&&ecEditor.updateContextMenu({id:"paste",state:"SHOW",data:{}})},pasteItem:function(){var e=this;this.clipboard&&(_.isArray(this.clipboard)?(ecEditor.getCanvas().discardActiveGroup(),this.clipboard.forEach(function(t,i){t.editorObj.top=e.activeGroup[i].top+10,t.editorObj.left=e.activeGroup[i].left+10,ecEditor.cloneInstance(t)})):ecEditor.cloneInstance(this.clipboard),this.clipboard=void 0,ecEditor.updateContextMenu({id:"paste",state:"HIDE",data:{}}))},deleteObject:function(e,t){var i=ecEditor.getEditorGroup(),d=ecEditor.getEditorObject(),r=this;i?(ecEditor.getCanvas().discardActiveGroup(),i.getObjects().forEach(function(e){r.remove(e)})):d&&r.remove(d)},remove:function(e){ecEditor.dispatchEvent("delete:invoked",{editorObj:ecEditor.getPluginInstance(e.id).attributes}),ecEditor.getCanvas().remove(e),ecEditor.dispatchEvent("stage:modified",{id:e.id})},objectSelected:function(e,t){ecEditor.updateContextMenus([{id:"reorder",state:"SHOW",data:{}},{id:"copy",state:"SHOW",data:{}},{id:"delete",state:"SHOW",data:{}}])},objectUnSelected:function(e,t){ecEditor.updateContextMenus([{id:"reorder",state:"HIDE",data:{}},{id:"copy",state:"HIDE",data:{}},{id:"delete",state:"HIDE",data:{}}])}});'))
org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.help-1.0/editor/libs/micromarkdown.min.js', 'js')
org.ekstep.pluginframework.pluginManager.registerPlugin({"id":"org.ekstep.help","ver":"1.0","displayName":"Help","author":"Sunil A S","title":"Help Plugin","description":"","publishedDate":"","editor":{"main":"editor/plugin.js","dependencies":[{"type":"js","src":"editor/libs/micromarkdown.min.js"}],"sidebarMenu":[{"id":"help","type":"icon","toolTip":"Help","title":"Help","iconClass":"help icon","templateURL":"editor/partials/sidebarHelpTemplate.html"}]}},eval('org.ekstep.contenteditor.basePlugin.extend({type:"help",initialize:function(){org.ekstep.contenteditor.api.addEventListener("sidebar:help",this.showHelpTab,this),org.ekstep.contenteditor.api.addEventListener("object:selected",this.showHelpTab,this),org.ekstep.contenteditor.api.addEventListener("object:unselected",this.showHelpTab,this)},showHelpTab:function(){org.ekstep.contenteditor.api.getCurrentObject()?org.ekstep.contenteditor.api.getCurrentObject().getHelp(function(e){org.ekstep.contenteditor.api.jQuery("#pluginHelpContent").html(micromarkdown.parse(e))}):org.ekstep.contenteditor.api.getCurrentStage().getHelp(function(e){org.ekstep.contenteditor.api.jQuery("#pluginHelpContent").html(micromarkdown.parse(e))})}});'))
org.ekstep.pluginframework.pluginManager.registerPlugin({"id":"org.ekstep.editorstate","ver":"1.0","shortId":"editorstate","author":"Sunil A S","title":"Editor State","description":"","publishedDate":"","editor":{"main":"editor/plugin.js"}},eval('org.ekstep.contenteditor.basePlugin.extend({extPluginsList:[],state:{plugin:{},stage:{},sidebar:{}},initialize:function(){var t=this;ecEditor.addEventListener("content:before:save",function(){ecEditor.dispatchEvent(t.manifest.id+":state",t.getEditorState(),t)},this),ecEditor.addEventListener("content:load:complete",this.setEditorState,this),ecEditor.addEventListener("plugin:load",function(e,i){t.extPluginsList.push({plugin:i.plugin,version:i.version})})},getEditorState:function(){return this.state.plugin={noOfExtPlugins:this.extPluginsList.length,extPlugins:this.extPluginsList},this.state.stage={noOfStages:ecEditor.getAllStages().length,currentStage:ecEditor.getCurrentStage().id,selectedPluginObject:ecEditor.getCurrentObject().id||void 0},this.state.sidebar={selectedMenu:ecEditor.getCurrentSidebarMenu()},this.state},setEditorState:function(){this.setStageState(),this.setPluginState(),this.setSidebarState()},_getStateFromService:function(){if(ecEditor.getService(ServiceConstants.CONTENT_SERVICE).getContentMeta(ecEditor.getContext("contentId")).editorState)return JSON.parse(ecEditor.getService(ServiceConstants.CONTENT_SERVICE).getContentMeta(ecEditor.getContext("contentId")).editorState)},setStageState:function(){var t=this._getStateFromService();t&&t.stage?(ecEditor.dispatchEvent("stage:select",{stageId:t.stage.currentStage}),t.stage.selectedPluginObject&&_.forEach(ecEditor.getStage(t.stage.currentStage).children,function(e){e.id===t.stage.selectedPluginObject&&ecEditor.getCurrentStage().canvas.setActiveObject(e.editorObj)})):ecEditor.dispatchEvent("stage:select",{stageId:ecEditor.getAllStages()[0].id})},setPluginState:function(){var t=this._getStateFromService();t&&t.plugin&&t.plugin.extPlugins.forEach(function(t){ecEditor.loadPlugin(t.plugin,t.version)})},setSidebarState:function(){var t=this._getStateFromService();t&&t.sidebar?ecEditor.showSidebarMenu(t.sidebar.selectedMenu):ecEditor.showSidebarMenu("settings")}});'))
org.ekstep.pluginframework.pluginManager.registerPlugin({"id":"org.ekstep.contenteditorfunctions","ver":"1.2","author":"Sunil A S","description":"","publishedDate":"","editor":{"main":"editor/plugin.js","dependencies":[{"type":"plugin","plugin":"org.ekstep.toaster","ver":"1.0"}]}},eval('org.ekstep.contenteditor.basePlugin.extend({editorState:void 0,telemetryService:org.ekstep.contenteditor.api.getService(ServiceConstants.TELEMETRY_SERVICE),lastSaved:void 0,popUpValues:{},isSaveNotificationPopupOpened:!1,contentService:org.ekstep.contenteditor.api.getService(ServiceConstants.CONTENT_SERVICE),popupService:org.ekstep.contenteditor.api.getService(ServiceConstants.POPUP_SERVICE),conflictdialogOptions:{showPlatformPreview:!1},initialize:function(){var e=this;ecEditor.addEventListener("org.ekstep.editorstate:state",this.setEditorState,this),ecEditor.addEventListener("org.ekstep.contenteditor:save",this.resolveSaveFn,this),ecEditor.addEventListener("org.ekstep.contenteditor:save:meta",this.saveMetadata,this),ecEditor.addEventListener("org.ekstep.contenteditor:preview",function(t,o){e.previewContent(o.fromBeginning)},this),ecEditor.addEventListener("org.ekstep.contenteditor:save:force",this.saveBrowserContent,this),ecEditor.addEventListener("org.ekstep.contenteditor:review",this.reviewContent,this),ecEditor.addEventListener("org.ekstep.contenteditor:publish",this.publishContent,this),ecEditor.addEventListener("org.ekstep.contenteditor:reject",this.rejectContent,this),ecEditor.addEventListener("org.ekstep.contenteditor:acceptFlag",this.acceptContentFlag,this),ecEditor.addEventListener("org.ekstep.contenteditor:discardFlag",this.discardContentFlag,this),ecEditor.addEventListener("org.ekstep.contenteditor:retire",this.retireContent,this),ecEditor.addEventListener("org.ekstep.contenteditor:unlistedPublish",this.unlistedPublishContent,this)},setEditorState:function(e,t){t&&(this.editorState=t)},reviewContent:function(e,t){var o=ecEditor.getContext("contentId");ecEditor.getService(ServiceConstants.CONTENT_SERVICE).sendForReview({contentId:o,channel:ecEditor.getContext("channel")},function(e,o){o&&o.data&&"OK"==o.data.responseCode?(ecEditor.dispatchEvent("org.ekstep.toaster:success",{title:"Content sent for review...",position:"topCenter",icon:"fa fa-check-circle"}),t&&t(e,o)):(ecEditor.dispatchEvent("org.ekstep.toaster:error",{message:"Sending for review failed, please try again later...",position:"topCenter",icon:"fa fa-warning"}),t&&t(e,o))})},resolveSaveFn:function(e,t){switch(ecEditor.getService(ServiceConstants.CONTENT_SERVICE).getContentMeta(ecEditor.getContext("contentId")).mimeType){case"application/vnd.ekstep.ecml-archive":this.saveContent(e,t),this.conflictdialogOptions.showPlatformPreview=!0;break;case"application/vnd.ekstep.content-collection":this.saveCollectionContent(e,t);break;case"application/vnd.ekstep.html-archive":case"application/vnd.ekstep.h5p-archive":case"application/epub":case"video/mp4":case"application/pdf":case"video/x-youtube":case"video/webm":case"text/x-url":this.saveGenericEditorContent(e,t);break;default:t.callback&&t.callback("unable to resolve save call for the mimetype")}},saveGenericEditorContent:function(e,t){var o=ecEditor._.assign({savingPopup:!0,successPopup:!0,failPopup:!0},t);o.savingPopup&&this.saveNotification("saving"),this._patchContent(t,t.body,o)},saveContent:function(e,t){console.log("Save invoked:",e,t),t=ecEditor._.assign({savingPopup:!0,successPopup:!0,failPopup:!0,callback:function(){}},t),t.savingPopup&&this.saveNotification("saving");var o={};t.contentMeta&&(o=t.contentMeta),o.stageIcons=JSON.stringify(org.ekstep.contenteditor.stageManager.getStageIcons()),org.ekstep.pluginframework.eventManager.dispatchEvent("content:before:save");var i=org.ekstep.contenteditor.stageManager.toECML(),n=org.ekstep.contenteditor.stageManager.getSummary();if(n){o.totalQuestions=n.totalQuestions,o.totalScore=n.totalScore;var a=ecEditor.getService(ServiceConstants.CONTENT_SERVICE).getContentMeta(ecEditor.getContext("contentId"));ecEditor._.isEqual(ecEditor._.map(n.questions,"identifier").sort(),ecEditor._.map(a.questions,"identifier").sort())||(o.questions=n.questions)}o.editorState=JSON.stringify(this.editorState),o.pragma=org.ekstep.contenteditor.stageManager.getPragma(),this._patchContent(o,i,t)},_patchContent:function(e,t,o){var i=this;e&&(e=JSON.parse(angular.toJson(e))),this.patchContent(e,t,function(e,t){if(e)t&&!ecEditor._.isUndefined(t.responseJSON)?"ERR_STALE_VERSION_KEY"==t.responseJSON.params.err?i.showConflictDialog(o):i.changePopupValues("error"):o&&o.failPopup&&(o.savingPopup||i.saveNotification(),i.changePopupValues("error"));else if(t&&"OK"==t.data.responseCode){var n=ecEditor.getService(ServiceConstants.CONTENT_SERVICE).getContentMeta(ecEditor.getContext("contentId"));if("application/vnd.ekstep.content-collection"===n.mimeType&&org.ekstep.services.stateService.state.dialCodeMap){var a=_.get(org.ekstep.services.stateService.state.dialCodeMap,ecEditor.getContext("contentId"));_.isUndefined(a)||(i.dialcodeLink([{dialcode:a,identifier:ecEditor.getContext("contentId")}]),i.storeDialCodes(ecEditor.getContext("contentId"),a),_.unset(org.ekstep.services.stateService.state.dialCodeMap,ecEditor.getContext("contentId")))}o&&o.successPopup&&(o.savingPopup||i.saveNotification(),i.changePopupValues("success")),ecEditor.dispatchEvent("org.ekstep.contenteditor:after-save",{})}"function"==typeof o.callback&&o.callback(e,t)},o)},saveBrowserContent:function(e,t){var o=this;this.fetchPlatformContentVersionKey(function(i){o.resolveSaveFn(e,t)})},patchContent:function(e,t,o,i){var n=this;if(org.ekstep.contenteditor.migration&&org.ekstep.contenteditor.migration.isMigratedContent()){e||(e={}),e.oldContentBody=org.ekstep.contenteditor.migration.getBackupContent();var a=function(a,s){s&&n.contentService.saveContent(org.ekstep.contenteditor.api.getContext("contentId"),e,t,o),a&&i&&i.callback("save action interrupted by user")};n.showMigratedContentSaveDialog(a)}else n.contentService.saveContent(org.ekstep.contenteditor.api.getContext("contentId"),e,t,o)},saveMetadata:function(e,t){this._patchContent(t.contentMeta,void 0,t)},showMigratedContentSaveDialog:function(e){var t=this;this.popupService.open({template:ecEditor.resolvePluginResource(t.manifest.id,t.manifest.ver,"editor/partials/migratedContentSaveMsg.html"),controller:["$scope",function(o){o.saveContent=function(){org.ekstep.contenteditor.migration.clearMigrationFlag(),e(void 0,!0)},o.enableSaveBtn=function(){t.saveBtnEnabled=!0,e(!0,void 0)}}],showClose:!1,closeByDocument:!1,closeByEscape:!1})},saveNotification:function(e){var t=this,o={template:ecEditor.resolvePluginResource(t.manifest.id,t.manifest.ver,"editor/partials/saveMessage.html"),controller:["$scope",function(e){e.popUpValues=t.popUpValues,e.$on("ngDialog.opened",function(e,o){t.isSaveNotificationPopupOpened=!0})}],showClose:!1,closeByEscape:!1,closeByDocument:!1};console.log("config",o),this.changePopupValues(e),t.isSaveNotificationPopupOpened||this.popupService.open(o,function(){t.isSaveNotificationPopupOpened=!1})},changePopupValues:function(e){"success"===e?(this.popUpValues.headerMsg="Content Saved!",this.popUpValues.popUpIcon="circle check green",this.popUpValues.showCloseButton=!0,this.popUpValues.saveNotificationCloseButton="saveSuccessNotificationCloseButton"):"error"===e&&(this.popUpValues.headerMsg="Failed to save Content",this.popUpValues.popUpIcon="circle remove red",this.popUpValues.showCloseButton=!0,this.popUpValues.saveNotificationCloseButton="saveFailNotificationCloseButton"),"saving"===e&&(this.popUpValues.headerMsg="Saving content please wait...",this.popUpValues.showCloseButton=!1)},showConflictDialog:function(e){var t=this;this.popupService.open({template:ecEditor.resolvePluginResource(t.manifest.id,t.manifest.ver,"editor/partials/conflictDialog.html"),controller:["$scope",function(o){o.showPlatformPreview=!1,t.conflictdialogOptions.showPlatformPreview&&(o.showPlatformPreview=!0),o.previewPlatformContent=function(){t.previewPlatformContent()},o.saveBrowserContent=function(){t.saveBrowserContent(void 0,e),o.closeThisDialog()},o.previewContent=function(){t.previewContent()},o.refreshContent=function(){t.refreshContent()},o.firetelemetry=function(e,o){t.telemetryService.interact({type:"click",subtype:"popup",target:o,pluginid:"org.ekstep.contenteditorfunctions",pluginver:"1.2",objectid:e.id,stage:ecEditor.getCurrentStage().id})},o.showAdvancedOption=!1}],className:"ngdialog-theme-plain header-conflict-dialog",showClose:!1,closeByDocument:!0,closeByEscape:!0})},previewContent:function(e){var t=!!_.isUndefined(e);org.ekstep.pluginframework.eventManager.dispatchEvent("atpreview:show",{contentBody:org.ekstep.contenteditor.stageManager.toECML(),currentStage:t})},refreshContent:function(){location.reload()},previewPlatformContent:function(){this.fetchPlatformContentBody(function(e){org.ekstep.pluginframework.eventManager.dispatchEvent("atpreview:show",{contentBody:e,currentStage:!0})})},fetchPlatformContentVersionKey:function(e){org.ekstep.contenteditor.api.getService(ServiceConstants.CONTENT_SERVICE).getContentVersionKey(org.ekstep.contenteditor.api.getContext("contentId"),function(t,o){t&&alert("Failed to get updated version key. Please report an issue."),o.versionKey&&e(o)})},fetchPlatformContentBody:function(e){org.ekstep.contenteditor.api.getService(ServiceConstants.CONTENT_SERVICE).getContent(org.ekstep.contenteditor.api.getContext("contentId"),function(t,o){if(t&&alert("Failed to get updated content. Please report an issue."),o&&o.body)try{var i=JSON.parse(o.body);e(i)}catch(e){alert("Failed to parse body from platform. Please report an issue.")}})},publishContent:function(e,t){var o=ecEditor.getContext("contentId");ecEditor.getService(ServiceConstants.CONTENT_SERVICE).publishContent({contentId:o,channel:ecEditor.getContext("channel"),data:t},function(e,o){o&&o.data&&"OK"==o.data.responseCode?ecEditor.dispatchEvent("org.ekstep.toaster:success",{title:"Content published successfully!",position:"topCenter",icon:"fa fa-check-circle"}):ecEditor.dispatchEvent("org.ekstep.toaster:error",{message:"Unable to publish content, try again!",position:"topCenter",icon:"fa fa-warning"}),t.callback&&t.callback(e,o)})},rejectContent:function(e,t){ecEditor.getService(ServiceConstants.CONTENT_SERVICE).rejectContent({contentId:ecEditor.getContext("contentId"),channel:ecEditor.getContext("channel"),data:t},function(e,o){o&&o.data&&"OK"==o.data.responseCode?ecEditor.dispatchEvent("org.ekstep.toaster:success",{title:"Content rejected successfully!",position:"topCenter",icon:"fa fa-check-circle"}):ecEditor.dispatchEvent("org.ekstep.toaster:error",{message:"Unable to reject content, try again!",position:"topCenter",icon:"fa fa-warning"}),t.callback&&t.callback(e,o)})},acceptContentFlag:function(e,t){ecEditor.getService(ServiceConstants.CONTENT_SERVICE).acceptContentFlag({contentId:ecEditor.getContext("contentId")},function(e,o){o&&o.data&&"OK"==o.data.responseCode?ecEditor.dispatchEvent("org.ekstep.toaster:success",{title:"Content flag accepted successfully!",position:"topCenter",icon:"fa fa-check-circle"}):ecEditor.dispatchEvent("org.ekstep.toaster:error",{message:"Unable to accept content flag, try again!",position:"topCenter",icon:"fa fa-warning"}),t.callback&&t.callback(e,o)})},discardContentFlag:function(e,t){ecEditor.getService(ServiceConstants.CONTENT_SERVICE).discardContentFlag({contentId:ecEditor.getContext("contentId")},function(e,o){o&&o.data&&"OK"==o.data.responseCode?ecEditor.dispatchEvent("org.ekstep.toaster:success",{title:"Content flag discarded successfully!",position:"topCenter",icon:"fa fa-check-circle"}):ecEditor.dispatchEvent("org.ekstep.toaster:error",{message:"Unable to discard content flag, try again!",position:"topCenter",icon:"fa fa-warning"}),t.callback&&t.callback(e,o)})},retireContent:function(e,t){ecEditor.getService(ServiceConstants.CONTENT_SERVICE).retireContent({contentId:ecEditor.getContext("contentId")},function(e,o){o&&o.data&&"OK"==o.data.responseCode?ecEditor.dispatchEvent("org.ekstep.toaster:success",{title:"Content retired successfully!",position:"topCenter",icon:"fa fa-check-circle"}):ecEditor.dispatchEvent("org.ekstep.toaster:error",{message:"Unable to retire content, try again!",position:"topCenter",icon:"fa fa-warning"}),t.callback&&t.callback(e,o)})},saveCollectionContent:function(e,t){t=t||{};var o=this,i={validNodes:[],invalidNodes:[]},n=org.ekstep.collectioneditor.api.getService("collection").getCollectionHierarchy();n&&(n=JSON.parse(angular.toJson(n))),console.log("contentBody",n);!function(){var e=["name","contentType","mimeType"];ecEditor._.forIn(org.ekstep.collectioneditor.cache.nodesModified,function(t,o){e.forEach(function(e){t.metadata.hasOwnProperty(e)&&t.metadata[e]?i.validNodes.push(o):i.invalidNodes.push(o)})})}();if(this.lowlightNode(i.validNodes),_.size(i.invalidNodes)>0)return t.showNotification&&ecEditor.dispatchEvent("org.ekstep.toaster:error",{message:"Please update the collection details before save",position:"topCenter",icon:"fa fa-warning"}),this.hightlightNode(i.invalidNodes),t.callback&&t.callback("mandatory fields are missing in the data!"),!1;ecEditor.getService(ServiceConstants.CONTENT_SERVICE).saveCollectionHierarchy({body:n},function(e,i){i&&i.data&&"OK"==i.data.responseCode?(t.showNotification&&ecEditor.dispatchEvent("org.ekstep.toaster:success",{title:"Content saved successfully!",position:"topCenter",icon:"fa fa-check-circle"}),o.highlightNodeForInvalidDialCode(i,n.nodesModified),org.ekstep.collectioneditor.api.getService("collection").clearCache(),ecEditor._.forIn(i.data.result.identifiers,function(e,t){var o=ecEditor.getService(ServiceConstants.COLLECTION_SERVICE).getNodeById(t);o&&(o.data.id=e)}),ecEditor.dispatchEvent("meta:after:save",{})):e&&401===i.status&&"Unauthorized"===i.statusText?t.showNotification&&ecEditor.dispatchEvent("org.ekstep.toaster:error",{message:"Your session has timed out due to inactivity. Please login to resume!",position:"topCenter",icon:"fa fa-warning"}):t.showNotification&&ecEditor.dispatchEvent("org.ekstep.toaster:error",{message:"Unable to save the content, try again!",position:"topCenter",icon:"fa fa-warning"}),t.callback&&t.callback(e,i)})},highlightNodeForInvalidDialCode:function(e,t){var o=this,i=[];ecEditor._.forEach(org.ekstep.services.stateService.state.invaliddialCodeMap,function(t,i){_.has(e.data.result.identifiers,i)?(delete org.ekstep.services.stateService.state.invaliddialCodeMap[i],org.ekstep.services.stateService.setState("invaliddialCodeMap",e.data.result.identifiers[i],t),org.ekstep.services.collectionService.highlightNode(e.data.result.identifiers[i]),o.storeDialCodes(e.data.result.identifiers[i],t)):(o.storeDialCodes(i,t),org.ekstep.services.collectionService.highlightNode(i))}),ecEditor._.forEach(org.ekstep.services.stateService.state.dialCodeMap,function(t,n){_.has(e.data.result.identifiers,n)?(delete org.ekstep.services.stateService.state.dialCodeMap[n],org.ekstep.services.stateService.setState("dialCodeMap",e.data.result.identifiers[n],t),i.push({identifier:e.data.result.identifiers[n],dialcode:t}),org.ekstep.services.collectionService.lowLightNode(e.data.result.identifiers[n]),o.storeDialCodes(e.data.result.identifiers[n],t)):(i.push({identifier:n,dialcode:t}),org.ekstep.services.collectionService.lowLightNode(n),o.storeDialCodes(n,t))});var n=!1;ecEditor._.forIn(t,function(e){e.metadata.dialcodes&&!n&&(n=!0)}),n&&o.dialcodeLink(i)},dialcodeLink:function(e){_.find(e,"dialcode");if(_.isEmpty(e))ecEditor._.isEmpty(org.ekstep.services.stateService.state.invaliddialCodeMap)||ecEditor.dispatchEvent("org.ekstep.toaster:warning",{title:"Unable to update some of the DIAL codes.",position:"topCenter",icon:"fa fa-warning"});else{var t={request:{content:e}};ecEditor.getService("dialcode").dialcodeLink(ecEditor.getContext("channel"),t,function(e,t){e?ecEditor.dispatchEvent("org.ekstep.toaster:error",{title:"DIAL code(s) updating failed!",position:"topCenter",icon:"fa fa-warning"}):ecEditor._.isEmpty(org.ekstep.services.stateService.state.dialCodeMap)||ecEditor._.isEmpty(org.ekstep.services.stateService.state.invaliddialCodeMap)?ecEditor.dispatchEvent("org.ekstep.toaster:success",{title:"DIAL code(s) updated successfully!",position:"topCenter",icon:"fa fa-check-circle"}):ecEditor.dispatchEvent("org.ekstep.toaster:warning",{title:"Unable to update some of the DIAL codes.",position:"topCenter",icon:"fa fa-warning"})})}},storeDialCodes:function(e,t){var o=ecEditor.getService(ServiceConstants.COLLECTION_SERVICE).getNodeById(e);o&&o.data&&(o.data.metadata.dialcodes=t)},hightlightNode:function(e){_.forEach(_.omitBy(_.uniq(e),_.isEmpty),function(e){org.ekstep.services.collectionService.highlightNode(e)})},lowlightNode:function(e){_.forEach(_.omitBy(_.uniq(e),_.isEmpty),function(e){org.ekstep.services.collectionService.lowLightNode(e)})},unlistedPublishContent:function(e,t){var o=ecEditor.getContext("contentId");ecEditor.getService(ServiceConstants.CONTENT_SERVICE).unlistedPublishContent({contentId:o},function(e,o){o&&o.data&&"OK"==o.data.responseCode?ecEditor.dispatchEvent("org.ekstep.toaster:success",{title:"Content limited shared successfully!",position:"topCenter",icon:"fa fa-check-circle"}):ecEditor.dispatchEvent("org.ekstep.toaster:error",{message:"Unable to share content, try again!",position:"topCenter",icon:"fa fa-warning"}),t.callback&&t.callback(e,o)})}});'))
org.ekstep.pluginframework.pluginManager.registerPlugin({"id":"org.ekstep.keyboardshortcuts","ver":"1.0","author":"Akash Gupta","editor":{"main":"editor/plugin.js","views":[{"template":"./templates/shortcutspopup.html","controller":""}]}},eval('org.ekstep.contenteditor.basePlugin.extend({type:"shortcuts",isPopupOpen:!1,events:{copyElem:"copy:copyItem",pasteElem:"paste:pasteItem",deleteElem:"delete:invoke",createStage:"stage:create",duplicateStage:"stage:duplicate",saveContent:"org.ekstep.contenteditor:save",selectStage:"stage:select",sendToBack:"reorder:sendback",sendToFront:"reorder:bringfront"},initialize:function(){var e=this,t=ecEditor.resolvePluginResource(e.manifest.id,e.manifest.ver,"editor/templates/shortcutspopup.html");ecEditor.getService("popup").loadNgModules(t),ecEditor.registerKeyboardCommand("mod+c",function(t){t.preventDefault(),ecEditor.dispatchEvent(e.events.copyElem)}),ecEditor.registerKeyboardCommand("mod+v",function(t){t.preventDefault(),ecEditor.dispatchEvent(e.events.pasteElem),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})}),ecEditor.registerKeyboardCommand(["del","backspace"],function(t){t.preventDefault(),ecEditor.dispatchEvent(e.events.deleteElem),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})}),ecEditor.registerKeyboardCommand("ctrl+m",function(t){t.preventDefault(),ecEditor.dispatchEvent(e.events.createStage,{position:"afterCurrent"}),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})}),ecEditor.registerKeyboardCommand("mod+d",function(t){t.preventDefault(),ecEditor.dispatchEvent(e.events.duplicateStage,{stageId:org.ekstep.contenteditor.api.getCurrentStage().id}),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})}),ecEditor.registerKeyboardCommand("mod+x",function(t){t.preventDefault(),ecEditor.dispatchEvent(e.events.copyElem),ecEditor.dispatchEvent(e.events.deleteElem)}),ecEditor.registerKeyboardCommand("mod+a",function(e){e.preventDefault();var t=org.ekstep.contenteditor.api.getCanvas();t.deactivateAll();var r=t.getObjects().map(function(e){return e.set("active",!0)}),o=new fabric.Group(r,{originX:"left",originY:"top"});t.setActiveGroup(o.setCoords()).renderAll()}),org.ekstep.contenteditor.api.getCanvas().on("object:moving",e.moveRichText),ecEditor.registerKeyboardCommand("mod+s",function(t){t.preventDefault(),ecEditor.dispatchEvent(e.events.saveContent)}),ecEditor.registerKeyboardCommand("mod+/",function(r){r.preventDefault();var o=function(t){t.$on("ngDialog.opened",function(t,r){e.isPopupOpen=!0})};if(!e.isPopupOpen){ecEditor.getService("popup").open({templateUrl:t,controller:["$scope",o],width:900,showClose:!0,className:"ngdialog-theme-default"},function(){e.isPopupOpen=!1})}}),ecEditor.registerKeyboardCommand(["home","command+up"],function(t){t.preventDefault(),ecEditor.dispatchEvent(e.events.selectStage,{prevStageId:org.ekstep.contenteditor.api.getCurrentStage().id,stageId:org.ekstep.contenteditor.api.getAllStages()[0].id})}),ecEditor.registerKeyboardCommand(["end","command+down"],function(t){t.preventDefault(),ecEditor.dispatchEvent(e.events.selectStage,{prevStageId:org.ekstep.contenteditor.api.getCurrentStage().id,stageId:org.ekstep.contenteditor.stageManager.stages[org.ekstep.contenteditor.stageManager.stages.length-1].id})}),ecEditor.registerKeyboardCommand("mod+b",function(e){var t=org.ekstep.contenteditor.api.getCurrentObject();t&&(e.preventDefault(),t.onConfigChange("fontweight","bold"),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()}))}),ecEditor.registerKeyboardCommand("mod+i",function(e){var t=org.ekstep.contenteditor.api.getCurrentObject();t&&(e.preventDefault(),t.onConfigChange("fontstyle","italic"),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()}))}),ecEditor.registerKeyboardCommand("mod+shift+.",function(e){var t=org.ekstep.contenteditor.api.getCurrentObject();if(t){e.preventDefault();var r=t.getConfig().fontsize;r=parseInt(r,10),t.onConfigChange("fontsize",r+1),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})}}),ecEditor.registerKeyboardCommand("mod+shift+,",function(e){var t=org.ekstep.contenteditor.api.getCurrentObject();if(t){e.preventDefault();var r=t.getConfig().fontsize;r=parseInt(r,10),t.onConfigChange("fontsize",r-1),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})}}),ecEditor.registerKeyboardCommand("mod+alt+shift+l",function(e){var t=org.ekstep.contenteditor.api.getCurrentObject();t&&(e.preventDefault(),t.onConfigChange("align","left"),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()}))}),ecEditor.registerKeyboardCommand("mod+alt+shift+r",function(e){var t=org.ekstep.contenteditor.api.getCurrentObject();t&&(e.preventDefault(),t.onConfigChange("align","right"),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()}))}),ecEditor.registerKeyboardCommand("mod+alt+shift+e",function(e){var t=org.ekstep.contenteditor.api.getCurrentObject();t&&(e.preventDefault(),t.onConfigChange("align","center"),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()}))}),ecEditor.registerKeyboardCommand("mod+down",function(t){t.preventDefault(),ecEditor.dispatchEvent(e.events.sendToBack),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})}),ecEditor.registerKeyboardCommand("mod+up",function(t){t.preventDefault(),ecEditor.dispatchEvent(e.events.sendToFront),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})}),ecEditor.registerKeyboardCommand("up",function(e){var t=org.ekstep.contenteditor.api.getCurrentObject(),r=org.ekstep.contenteditor.api.getEditorGroup();if(r)e.preventDefault(),_.each(org.ekstep.contenteditor.api.getCurrentGroup(),function(e){var t=ecEditor.jQuery("#"+e.id);0!=t.length&&(t[0].style.top=parseInt(t[0].style.top,10)-3+"px"),e.setAttribute("y",e.attributes.y-3)}),r.top=r.top-3,org.ekstep.contenteditor.api.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()});else if(t){e.preventDefault();var o=ecEditor.jQuery("#"+t.id);0!=o.length&&(o[0].style.top=parseInt(o[0].style.top,10)-3+"px"),t.editorObj.top=t.editorObj.top-3,t.setAttribute("y",t.editorObj.top),org.ekstep.contenteditor.api.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})}}),ecEditor.registerKeyboardCommand("down",function(e){var t=org.ekstep.contenteditor.api.getCurrentObject(),r=org.ekstep.contenteditor.api.getEditorGroup();if(r)e.preventDefault(),_.each(org.ekstep.contenteditor.api.getCurrentGroup(),function(e){var t=ecEditor.jQuery("#"+e.id);0!=t.length&&(t[0].style.top=parseInt(t[0].style.top,10)+3+"px"),e.setAttribute("y",e.attributes.y+3)}),r.top=r.top+3,org.ekstep.contenteditor.api.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()});else if(t){e.preventDefault();var o=ecEditor.jQuery("#"+t.id);0!=o.length&&(o[0].style.top=parseInt(o[0].style.top,10)+3+"px"),t.editorObj.top=t.editorObj.top+3,t.setAttribute("y",t.editorObj.top),org.ekstep.contenteditor.api.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})}}),ecEditor.registerKeyboardCommand("left",function(e){var t=org.ekstep.contenteditor.api.getCurrentObject(),r=org.ekstep.contenteditor.api.getEditorGroup();if(r)e.preventDefault(),_.each(org.ekstep.contenteditor.api.getCurrentGroup(),function(e){var t=ecEditor.jQuery("#"+e.id);0!=t.length&&(t[0].style.left=parseInt(t[0].style.left,10)-3+"px"),e.setAttribute("x",e.attributes.x-3)}),r.left=r.left-3,org.ekstep.contenteditor.api.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()});else if(t){e.preventDefault();var o=ecEditor.jQuery("#"+t.id);0!=o.length&&(o[0].style.left=parseInt(o[0].style.left,10)-3+"px"),t.editorObj.left=t.editorObj.left-3,t.setAttribute("x",t.editorObj.left),org.ekstep.contenteditor.api.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})}}),ecEditor.registerKeyboardCommand("right",function(e){var t=org.ekstep.contenteditor.api.getCurrentObject(),r=org.ekstep.contenteditor.api.getEditorGroup();if(r)e.preventDefault(),_.each(org.ekstep.contenteditor.api.getCurrentGroup(),function(e){var t=ecEditor.jQuery("#"+e.id);0!=t.length&&(t[0].style.left=parseInt(t[0].style.left,10)+3+"px"),e.setAttribute("x",e.attributes.x+3)}),r.left=r.left+3,org.ekstep.contenteditor.api.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()});else if(t){e.preventDefault();var o=ecEditor.jQuery("#"+t.id);0!=o.length&&(o[0].style.left=parseInt(o[0].style.left,10)+3+"px"),t.editorObj.left=t.editorObj.left+3,t.setAttribute("x",t.editorObj.left),org.ekstep.contenteditor.api.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})}}),ecEditor.registerKeyboardCommand("shift+up",function(e){var t=org.ekstep.contenteditor.api.getCurrentObject(),r=org.ekstep.contenteditor.api.getEditorGroup();if(r)e.preventDefault(),_.each(org.ekstep.contenteditor.api.getCurrentGroup(),function(e){var t=ecEditor.jQuery("#"+e.id);0!=t.length&&(t[0].style.top=parseInt(t[0].style.top,10)-1+"px"),e.setAttribute("x",e.attributes.x-1)}),r.top=r.top-1,org.ekstep.contenteditor.api.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()});else if(t){e.preventDefault();var o=ecEditor.jQuery("#"+t.id);0!=o.length&&(o[0].style.top=parseInt(o[0].style.top,10)-1+"px"),t.editorObj.top=t.editorObj.top-1,t.setAttribute("y",t.editorObj.top),org.ekstep.contenteditor.api.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})}}),ecEditor.registerKeyboardCommand("shift+down",function(e){var t=org.ekstep.contenteditor.api.getCurrentObject(),r=org.ekstep.contenteditor.api.getEditorGroup();if(r)e.preventDefault(),_.each(org.ekstep.contenteditor.api.getCurrentGroup(),function(e){var t=ecEditor.jQuery("#"+e.id);0!=t.length&&(t[0].style.top=parseInt(t[0].style.top,10)+1+"px"),e.setAttribute("x",e.attributes.x+1)}),r.top=r.top+1,org.ekstep.contenteditor.api.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()});else if(t){e.preventDefault();var o=ecEditor.jQuery("#"+t.id);0!=o.length&&(o[0].style.top=parseInt(o[0].style.top,10)+1+"px"),t.editorObj.top=t.editorObj.top+1,t.setAttribute("y",t.editorObj.top),org.ekstep.contenteditor.api.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})}}),ecEditor.registerKeyboardCommand("shift+left",function(e){var t=org.ekstep.contenteditor.api.getCurrentObject(),r=org.ekstep.contenteditor.api.getEditorGroup();if(r)e.preventDefault(),_.each(org.ekstep.contenteditor.api.getCurrentGroup(),function(e){var t=ecEditor.jQuery("#"+e.id);0!=t.length&&(t[0].style.left=parseInt(t[0].style.left,10)-1+"px"),e.setAttribute("x",e.attributes.x-1)}),r.left=r.left-1,org.ekstep.contenteditor.api.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()});else if(t){e.preventDefault();var o=ecEditor.jQuery("#"+t.id);0!=o.length&&(o[0].style.left=parseInt(o[0].style.left,10)-1+"px"),t.editorObj.left=t.editorObj.left-1,t.setAttribute("x",t.editorObj.left),org.ekstep.contenteditor.api.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})}}),ecEditor.registerKeyboardCommand("shift+right",function(e){var t=org.ekstep.contenteditor.api.getCurrentObject(),r=org.ekstep.contenteditor.api.getEditorGroup();if(r)e.preventDefault(),_.each(org.ekstep.contenteditor.api.getCurrentGroup(),function(e){var t=ecEditor.jQuery("#"+e.id);0!=t.length&&(t[0].style.left=parseInt(t[0].style.left,10)+1+"px"),e.setAttribute("x",e.attributes.x+1)}),r.left=r.left+1,org.ekstep.contenteditor.api.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()});else if(t){e.preventDefault();var o=ecEditor.jQuery("#"+t.id);0!=o.length&&(o[0].style.left=parseInt(o[0].style.left,10)+1+"px"),t.editorObj.left=t.editorObj.left+1,t.setAttribute("x",t.editorObj.left),org.ekstep.contenteditor.api.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})}})},moveRichText:function(e){var t=org.ekstep.contenteditor.api.getEditorGroup();t&&_.each(t.getObjects(),function(e){0!=ecEditor.jQuery("#"+e.id).length&&ecEditor.jQuery("#"+e.id).css({top:t.top+t.height/2+e.top,left:t.left+t.width/2+e.left})})}});'))
org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.richtext-1.0/editor/libs/ckeditor.js', 'js')
org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.richtext-1.0/editor/style.css', 'css')
org.ekstep.pluginframework.pluginManager.registerPlugin({"id":"org.ekstep.richtext","ver":"1.0","shortId":"org.ekstep.richtext","displayName":"Rich Text","author":"Kartheek Palla","title":"Text Plugin","description":"","publishedDate":"","editor":{"main":"editor/plugin.js","dependencies":[{"type":"js","src":"editor/libs/ckeditor.js"},{"type":"css","src":"editor/style.css"}],"views":[{"template":"./richtexteditor.html","controller":"./richtexteditorapp.js"}],"behaviour":{"rotatable":false},"configManifest":[{"type":"custom_template","templateURL":"editor/configTemplate.html"}],"help":{"src":"editor/help.md","dataType":"text"}},"renderer":{"main":"renderer/richtextrendererplugin.js"}},eval('org.ekstep.contenteditor.basePlugin.extend({type:"org.ekstep.richtext",magicNumber:1920,editorWidth:720,richTextId:"richtext-wrapper",initialize:function(){var t=this;CKEDITOR.basePath=ecEditor.resolvePluginResource(this.manifest.id,this.manifest.ver,"editor/libs/"),ecEditor.addEventListener(this.type+":showpopup",this.loadHtml,this),ecEditor.addEventListener("stage:unselect",this.removeHtmlElements,this),ecEditor.addEventListener("stage:create",this.removeHtmlElements,this),ecEditor.addEventListener(t.manifest.id+":adddiv",this.addDivElement,this),org.ekstep.contenteditor.api.getCanvas().on("object:scaling",this.resizeObject,this);var e=ecEditor.resolvePluginResource(t.manifest.id,t.manifest.ver,"editor/richtexteditor.html"),i=ecEditor.resolvePluginResource(t.manifest.id,t.manifest.ver,"editor/richtexteditorapp.js");ecEditor.getService("popup").loadNgModules(e,i);var r=document.createElement("div");r.setAttribute("id",this.richTextId),r.setAttribute("class",this.richTextId),ecEditor.jQuery(".canvas-container").append(r)},newInstance:function(){var t=this;this.configManifest=_.remove(this.configManifest,function(t){return"stroke"!=t.propertyName});var e=this.convertToFabric(this.attributes);ecEditor._.isUndefined(this.config.text)&&(this.config.text=ecEditor._.isUndefined(this.attributes.__text)?"":this.attributes.__text),delete e.__text,this.editorObj=new fabric.Rect(e),this.editorObj.visible=!0,this.editorObj&&this.editorObj.setFill(e.fill),ecEditor.dispatchEvent(t.manifest.id+":adddiv",{data:t})},resizeObject:function(t){if(ecEditor.getCurrentObject()&&"org.ekstep.richtext"==ecEditor.getCurrentObject().manifest.id){var e=ecEditor.jQuery("#canvas").offset(),i=ecEditor.getCurrentObject();ecEditor.jQuery("#"+t.target.id).offset({top:t.target.top+e.top,left:t.target.left+e.left}),i.attributes.w=t.target.getWidth(),i.attributes.h=t.target.getHeight(),ecEditor.jQuery("#"+t.target.id).width(t.target.getWidth()),ecEditor.jQuery("#"+t.target.id).height(t.target.getHeight())}},moving:function(t){var e=ecEditor.jQuery("#canvas").offset();ecEditor.jQuery("#"+this.editorObj.id).offset({top:this.editorObj.top+e.top,left:this.editorObj.left+e.left})},selected:function(t){fabric.util.addListener(fabric.document,"dblclick",this.dblClickHandler)},deselected:function(t,e,i){fabric.util.removeListener(fabric.document,"dblclick",this.dblClickHandler)},removed:function(t,e,i){ecEditor.jQuery("div#"+t.id).remove()},addDivElement:function(t,e){var i=ecEditor.jQuery("#canvas").offset(),r=document.createElement("div");r.setAttribute("id",e.data.id),r.style.position="absolute",r.style.fontSize="14px",r.style.fontFamily="NotoSans",r.style.width=e.data.editorObj.width?e.data.editorObj.width+1+"px":"auto",r.style.height=e.data.editorObj.height?e.data.editorObj.height+1+"px":"auto",r.style.pointerEvents="none",ecEditor.jQuery(".canvas-container #"+this.richTextId).append(r),ecEditor.jQuery(".canvas-container #"+this.richTextId+" div#"+e.data.id).html(e.data.config.text),ecEditor.jQuery("#"+e.data.id).offset({top:e.data.editorObj.top+i.top,left:Number(parseInt(ecEditor.jQuery(".canvas-container").css("margin-left")))+(e.data.editorObj.left+i.left)});var d=ecEditor.jQuery("#"+e.data.id).width(),o=ecEditor.jQuery("#"+e.data.id).height();ecEditor.jQuery("#"+e.data.id).width(d),ecEditor.jQuery("#"+e.data.id).height(o),e.data.editorObj.width=d,e.data.editorObj.height=o},dblClickHandler:function(t){"canvas"==t.target.tagName.toLowerCase()&&ecEditor.getCurrentObject()&&"org.ekstep.richtext"===ecEditor.getCurrentObject().manifest.id&&ecEditor.dispatchEvent("org.ekstep.richtext:showpopup",{textSelected:!0})},loadHtml:function(t,e){document.getElementsByClassName("richtextEditor_1").length>0||(this.textSelected=!!e&&e.textSelected,currentInstance=this,ecEditor.getService("popup").open({template:"richtexteditor",controller:"richtexteditorcontroller",controllerAs:"$ctrl",resolve:{instance:function(){return currentInstance}},data:{textSelected:this.textSelected},width:500,showClose:!1,className:"ngdialog-theme-plain richtextEditor_1"}))},render:function(t){t.add(this.editorObj),ecEditor.dispatchEvent(this.manifest.id+":adddiv",{data:this})},removeHtmlElements:function(){org.ekstep.contenteditor.api.jQuery("#"+this.richTextId).empty()},getAttributes:function(){var t=this._super();return t.fontSize=this.updateFontSize(ecEditor.jQuery("#"+this.richTextId).css("font-size"),!1),t},getConfig:function(){var t=this._super();return t.fontsize=ecEditor.jQuery("#"+this.id).css("font-size"),t=_.omit(t,["stroke","strokeWidth"])},toECML:function(){return _.omit(this._super(),["__text"])},onConfigChange:function(t,e){var i="";switch(t){case"fontweight":_.each(ecEditor.jQuery("#"+this.id).children(),function(t){t.innerHTML="<strong>"+t.innerHTML+"</strong>",i+=t.outerHTML}),this.config.text=i;break;case"fontstyle":_.each(ecEditor.jQuery("#"+this.id).children(),function(t){t.innerHTML="<em>"+t.innerHTML+"</em>",i+=t.outerHTML}),this.config.text=i;break;case"fontsize":break;case"align":_.each(ecEditor.jQuery("#"+this.id).children(),function(t){t.style.textAlign=e,i+=t.outerHTML}),this.config.text=i}ecEditor.render(),ecEditor.dispatchEvent("object:modified",{target:ecEditor.getEditorObject()})},updateFontSize:function(t,e){var i,r,d=void 0;return e?(r=this.attributes.w*(this.magicNumber/100),d=this.editorWidth*this.attributes.w/100,i=parseInt(Math.round(t*(d/r)).toString())):(r=this.editorObj.width/this.magicNumber*100,d=this.editorObj.width/this.editorWidth*100,i=parseFloat((parseInt(t)*(d/r)).toFixed(2))),i}});'))
org.ekstep.pluginframework.pluginManager.registerPlugin({"id":"org.ekstep.iterator","ver":"1.0","author":"Jagadish","type":"plugin","title":"Iterator","description":"It is a base plugin for all collection plugins which needs navigation control","editor":{"main":"editor/plugin.js","dependencies":[],"menu":[]},"renderer":{"main":"renderer/plugin.js"},"icon":"assets/icon.png","languages":["English"],"categories":[""],"keywords":[""]},eval('org.ekstep.contenteditor.basePlugin.extend({initialize:function(){},newInstance:function(){}});'))
org.ekstep.pluginframework.pluginManager.registerPlugin({"id":"org.ekstep.navigation","ver":"1.0","author":"Jagadish","type":"plugin","title":"Navigation","description":"","editor":{"main":"editor/plugin.js","menu":[]},"renderer":{"main":"renderer/plugin.js","dependencies":[{"type":"js","src":"renderer/controller/navigation_ctrl.js","scope":"all"},{"type":"js","src":"renderer/templates/navigation.html","scope":"all"}]},"icon":"assets/icon.png","languages":["English"],"categories":[""],"keywords":[""]},eval('org.ekstep.contenteditor.basePlugin.extend({initialize:function(){var n=this;ecEditor.addEventListener("content:load:complete",function(t){ecEditor.instantiatePlugin(n.manifest.id,{},void 0)})},newInstance:function(){}});'))
org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.colorpicker-1.0/editor/libs/spectrum.js', 'js')
org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.colorpicker-1.0/editor/libs/spectrum.css', 'css')
org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.colorpicker-1.0/editor/colorpickerplugin.css', 'css')
org.ekstep.pluginframework.pluginManager.registerPlugin({"id":"org.ekstep.colorpicker","ver":"1.0","author":"Chetan Sachdev","title":"Colorpicker Plugin","description":"","publishedDate":"","editor":{"main":"editor/plugin.js","dependencies":[{"type":"js","src":"editor/libs/spectrum.js"},{"type":"css","src":"editor/libs/spectrum.css"},{"type":"css","src":"editor/colorpickerplugin.css"}],"menu":[]},"renderer":{}},eval('org.ekstep.contenteditor.basePlugin.extend({type:"colorpicker",picker:[],initialize:function(){ecEditor.addEventListener("colorpicker:state",this.invoke,this)},invoke:function(e,t){var c=this;"added"!=ecEditor.jQuery("#"+t.id+" input").attr("colorpicker")&&(this.picker[t.id]=ecEditor.jQuery("#"+t.id+" input").spectrum({color:"#FF0000",showInput:!0,showAlpha:!1,preferredFormat:"hex",showButtons:!1,containerClassName:"awesome",clickoutFiresChange:!1,showButtons:!0,change:function(e){t.callback(t.id,e.toHexString()),ecEditor.getService(ServiceConstants.TELEMETRY_SERVICE).interact({type:"click",subtype:"change",target:"colorpicker",pluginid:c.manifest.id,pluginver:c.manifest.ver,objectid:t.id,stage:ecEditor.getCurrentStage().id})},showPaletteOnly:!0,togglePaletteOnly:!0,togglePaletteMoreText:"more",togglePaletteLessText:"less",color:"blanchedalmond",palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]],maxSelectionSize:10,hideAfterPaletteSelect:!0,move:function(e){t.callback(t.id,e.toHexString()),ecEditor.getService(ServiceConstants.TELEMETRY_SERVICE).interact({type:"click",subtype:"move",target:"colorpicker",pluginid:c.manifest.id,pluginver:c.manifest.ver,objectid:t.id,stage:ecEditor.getCurrentStage().id})}}),ecEditor.jQuery("#"+t.id+" input").attr("colorpicker","added")),t&&t.color?ecEditor.jQuery("#"+t.id+" input").spectrum("set",t.color):ecEditor.jQuery("#"+t.id+" input").spectrum("set","#000000")}});'))
org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.config-1.0/editor/libs/jquery-ui.min.js', 'js')
org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.config-1.0/editor/config.css', 'css')
org.ekstep.pluginframework.pluginManager.registerPlugin({"id":"org.ekstep.config","ver":"1.0","author":"Santhosh Vasabhaktula","title":"Config Plugin","description":"","publishedDate":"","editor":{"main":"editor/plugin.js","dependencies":[{"type":"js","src":"editor/libs/jquery-ui.min.js"},{"type":"css","src":"editor/config.css"},{"type":"plugin","plugin":"org.ekstep.colorpicker","ver":"1.0"}],"sidebarMenu":[{"id":"settings","type":"icon","toolTip":"Settings","title":"Settings","iconClass":"settings icon","templateURL":"editor/partials/sidebarSettingTemplate.html","controllerURL":"editor/sidebar-settings-controller.js"}]}},eval('org.ekstep.contenteditor.basePlugin.extend({type:"config",initialize:function(){org.ekstep.contenteditor.api.addEventListener("org.ekstep.config:invoke",this.invoke,this),org.ekstep.contenteditor.api.addEventListener("org.ekstep.config:toggleStageEvent",this.toggleEventToStage,this),org.ekstep.contenteditor.api.addEventListener("config:updateValue",this.updateConfig,this),org.ekstep.contenteditor.api.addEventListener("config:on:change",this._onConfigChange,this),org.ekstep.contenteditor.api.addEventListener("config:add",this.addConfig,this);var e=org.ekstep.contenteditor.api.resolvePluginResource(this.manifest.id,this.manifest.ver,"editor/colorpicker-directive.js");org.ekstep.contenteditor.api.getService(ServiceConstants.POPUP_SERVICE).loadNgModules(void 0,e)},updateConfig:function(e,t){var n=this,o=org.ekstep.contenteditor.api._.reduce(t.oldValue,function(e,n,o){return org.ekstep.contenteditor.api._.isEqual(n,t.newValue[o])?e:e.concat(o)},[]);org.ekstep.contenteditor.api._.forEach(o,function(e){n.onConfigChange(e,t.newValue[e])})},_onConfigChange:function(e,t){this.onConfigChange(t.key,t.value)},onConfigChange:function(e,t){var n=org.ekstep.contenteditor.api.getCurrentObject()?org.ekstep.contenteditor.api.getCurrentObject():org.ekstep.contenteditor.api.getCurrentStage();!org.ekstep.contenteditor.api._.isUndefined(t)&&n&&(n._onConfigChange(e,t),n.onConfigChange(e,t),"autoplay"===e&&this.toggleEventToStage("",{flag:t,id:n.id}))},invoke:function(e,t){var n=this;if("browser"==t.type||"button"==t.type){var o=t.type;org.ekstep.contenteditor.api.dispatchEvent(t.event.id,{type:t.event.type,callback:function(e){n.onConfigChange(o,e)}})}},toggleEventToStage:function(e,t){var n=org.ekstep.contenteditor.api.getCurrentStage(),o=-1;n.event&&_.forEach(n.event,function(e,n){org.ekstep.contenteditor.api._.isArray(e.action)?e.action[0].asset===t.id&&(o=n):org.ekstep.contenteditor.api._.isObject(e.action)&&e.action.asset===t.id&&(o=n)}),!0===t.flag&&-1===o?n.addEvent({type:"enter",action:[{id:UUID(),type:"command",command:"play",asset:t.id}]}):!1===t.flag&&-1!==o&&n.event.splice(o,1)}});'))
org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.readalongbrowser-1.0/editor/libs/karaoke.js', 'js')
org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.readalongbrowser-1.0/editor/libs/jquery.scrollTo.js', 'js')
org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.readalongbrowser-1.0/editor/libs/jquery.jplayer.min.js', 'js')
org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.readalongbrowser-1.0/editor/css/jquery-ui.css', 'css')
org.ekstep.pluginframework.pluginManager.registerPlugin({"id":"org.ekstep.readalongbrowser","ver":"1.0","shortId":"readalongbrowser","author":"Kartheek Palla","title":"Read-along Plugin","description":"","publishedDate":"","editor":{"main":"editor/plugin.js","help":{"src":"editor/help.md","dataType":"text"},"dependencies":[{"type":"js","src":"editor/libs/karaoke.js"},{"type":"js","src":"editor/libs/jquery.scrollTo.js"},{"type":"js","src":"editor/libs/jquery.jplayer.min.js"},{"type":"css","src":"editor/css/jquery-ui.css"}],"views":[{"template":"./readalongbrowser.html","controller":"./readalongbrowserapp.js"}],"configManifest":[{"propertyName":"highlight","title":"Highlight Color","description":"Choose a color from the color picker to highlight the text","dataType":"colorpicker","required":true,"defaultValue":"#FFFF00"},{"propertyName":"color","title":"Font color","description":"Choose a color from the color picker","dataType":"colorpicker","required":true,"defaultValue":"rgb(255,0,0)"},{"propertyName":"font","dataType":"group","description":"Choose fontweight and fontstyle","config":[{"propertyName":"fontweight","title":"Font Weight","toolTip":"Bold","description":"Select font size for the text","dataType":"icon","iconClass":"bold icon","required":true,"defaultValue":false},{"propertyName":"fontstyle","title":"Font Style","toolTip":"Italic","description":"Select font style for the text","dataType":"icon","iconClass":"italic icon","required":true,"defaultValue":false}]},{"propertyName":"fontfamily","title":"Font Family","description":"Select font family for the text","dataType":"select","range":["Arial","Courier","Georgia","Helvetica","Monospace","Sans-serif","Serif","Tahoma","Times","Trebuchet MS","Verdana","NotoSansKannada","NotoSansGujarati","NotoSansBengali","NotoSansGurmukhi","NotoSansOriya","NotoSansDevanagari","NotoSansTamil","NotoSansTelugu","NotoNastaliqUrdu","NotoSansMalayalam"],"required":true,"defaultValue":"Sans-serif"},{"propertyName":"fontsize","title":"Font Size","description":"Select font size for the text","dataType":"select","range":[18,20,22,24,26,28,32,36,40,44,48,54,60,66,72,80,88,96],"required":true,"defaultValue":18}],"playable":true}},eval('org.ekstep.contenteditor.basePlugin.extend({type:"readalongbrowser",magicNumber:1920,editorWidth:720,currentInstance:void 0,cb:void 0,text:void 0,initialize:function(){var e=this;ecEditor.addEventListener("object:unselected",this.objectUnselected,this),ecEditor.addEventListener("delete:invoked",this.deleteObject,this),ecEditor.addEventListener(e.manifest.id+":showpopup",this.loadHtml,this),setTimeout(function(){var t=ecEditor.resolvePluginResource(e.manifest.id,e.manifest.ver,"editor/readalongbrowser.html"),r=ecEditor.resolvePluginResource(e.manifest.id,e.manifest.ver,"editor/readalongbrowserapp.js");ecEditor.getService("popup").loadNgModules(t,r)},1e3)},loadHtml:function(e,t){currentInstance=this,this.cb=t.callback,this.attributes=t.textObj.attributes,this.config=t.textObj.config,"readalong"==t.textObj.attributes.textType&&(this.editorObj=t.textObj.editorObj),ecEditor.getService("popup").open({template:"readalongbrowser",controller:"readalongbrowsercontroller",controllerAs:"$ctrl",resolve:{instance:function(){return currentInstance}},width:900,showClose:!1,className:"ngdialog-theme-plain"},function(){ecEditor._.isUndefined(currentInstance.editorObj)||currentInstance.editorObj.text||(currentInstance.editorObj.remove(),ecEditor.render())})},invokeKaraoke:function(e,t){var r=new Karaoke;if(r.audioObj.url=e,t){var i=ecEditor._.isEmpty(t.config.timings)?"":ecEditor._.split(t.config.timings,","),o=[],d=[],c=ecEditor._.split(t.attributes.__text," "),n=0;ecEditor._.each(i,function(e,t){n+=1,d.push({word:c[t],stepNo:10*parseFloat(e/1e3).toFixed(1),wordIdx:n}),o.push(parseFloat(e/1e3).toFixed(1))}),r.audioObj.url=e,r.audioObj.wordMap=d,r.audioObj.wordTimes=o,r.audioObj.highlightColor=t.config.highlight}else r.audioObj.url=e,r.audioObj.wordMap="",r.audioObj.wordTimes="",r.audioObj.highlightColor="",ecEditor.jQuery("#jplayerSync").data("jPlayer","");return ecEditor.jQuery("#syncSlider").bind("click",ecEditor.jQuery.proxy(r.changePlaybackRate,r)),ecEditor.jQuery("#changeaudio").bind("click",ecEditor.jQuery.proxy(r.res,r)),ecEditor.jQuery("#syncStart").bind("click",ecEditor.jQuery.proxy(r.startSync,r)),ecEditor.jQuery("#pick-hcolor").bind("click",ecEditor.jQuery.proxy(r.setColor,r)),ecEditor.jQuery("#stopAudio").bind("click",ecEditor.jQuery.proxy(r.stopAudio,r)),ecEditor.jQuery(".slideStep").bind("drop",ecEditor.jQuery.proxy(r.handleWordDrop,r)),ecEditor.jQuery("#syncMark").bind("click",ecEditor.jQuery.proxy(r.markWords,r)),ecEditor.jQuery("#sync-play").bind("click",ecEditor.jQuery.proxy(r.playSyncedLayer,r)),ecEditor.jQuery("#sync-pause").bind("click",ecEditor.jQuery.proxy(r.pauseAudio,r)),window.karaoke=r,r.initPlayer(),r}});'))
org.ekstep.pluginframework.resourceManager.loadExternalResource('/plugins/org.ekstep.reviewercomments-1.0/editor/comments.css', 'css')
org.ekstep.pluginframework.pluginManager.registerPlugin({"id":"org.ekstep.reviewercomments","ver":"1.0","author":"Revathi P","title":"Reviewer Comments","description":"","publishedDate":"","editor":{"main":"editor/plugin.js","dependencies":[{"type":"css","src":"editor/comments.css"}],"menu":[],"sidebarMenu":[{"id":"comments","type":"icon","toolTip":"comments","title":"comments","iconClass":"comment icon","templateURL":"editor/partials/sidebarCommentsTemplate.html"}]}},eval('org.ekstep.contenteditor.basePlugin.extend({NO_COMMENTS:"No Reviewer Comments",initialize:function(){ecEditor.addEventListener("stage:render:complete",this.initializeComments,this)},initializeComments:function(e,t){var n=this;if(void 0==n.comments){if(this.context=org.ekstep.contenteditor.globalContext,!ecEditor._.get(this.context.contentId)){var n=this,o=ecEditor.getService("content").getContentMeta(org.ekstep.contenteditor.api.getContext("contentId")).pkgVersion,i={request:{contextDetails:{contentId:ecEditor.getContext("contentId"),contentType:ecEditor.getService("content").getContentMeta(org.ekstep.contenteditor.api.getContext("contentId")).mimeType,contentVer:_.isUndefined(o)?"0":o.toString()}}};ecEditor.getService(ServiceConstants.CONTENT_SERVICE).getComments(i,function(e,t){try{t&&t.data.responseCode&&t.data.result.comments&&n.showComments(t.data.result.comments)}catch(e){n.displayNoComments(),ecEditor.dispatchEvent("org.ekstep.toaster:error",{message:"Error in fetching comments, please try again!",position:"topCenter",icon:"fa fa-warning"}),ecEditor.getService("telemetry").error({env:"content",stage:ecEditor.getCurrentStage().id,action:"review comments",objectid:"",objecttype:"",err:e.status,type:"API",data:e,severity:"fatal"}),console.warn("error in fetching review comments: ",e)}})}}else n.displayStageComments(n.comments)},showComments:function(e){var t={};e&&(t=_.sortBy(e,function(e){return new Date(e.createdOn)}),this.mapComment(t))},displayNoComments:function(){jQuery(\'a[data-content ="comments"]\').removeClass("highlight"),ecEditor.jQuery("#reviewerComments").html("<div>"+this.NO_COMMENTS+"</div>")},getMonthName:function(e){var e=new Date(e);return e.toLocaleString("en-us",{month:"long"}).toString().substr(0,3)+" "+e.getDate()},mapComment:function(e){var t=this,n=[];_.map(e,function(e){var o={};o.username=e.userInfo.name,o.logo=e.userInfo.logo?e.userInfo.logo:ecEditor.resolvePluginResource(t.manifest.id,t.manifest.ver,"assets/reviewer_icon.png"),o.username=e.userInfo.name,o.date=t.getMonthName(e.createdOn),o.body=e.body,o.stageId=e.stageId,n.push(o)});t.comments=n,t.displayStageComments()},filterComments:function(){var e=this;return _.filter(e.comments,["stageId",ecEditor.getCurrentStage().id])},displayStageComments:function(){if(filteredComments=[],filteredComments=this.filterComments(),filteredComments.length>0){var e=_.template(\'<% _.each(filteredComments, function(item) { %><div class="comment"> <div class="avatar"><img src= " <%-item.logo %> "/></div><div class="content"><div class="flex-class"><span class="author"><%- item.username %></span><span class="date"><%- item.date %> </span></div><div class="text"> <%-item.body  %> </div></div></div><% }); %>\');ecEditor.jQuery(\'a[data-content ="comments"]\').addClass("highlight"),ecEditor.jQuery("#reviewerComments").html(e)}else this.displayNoComments()}});'))
